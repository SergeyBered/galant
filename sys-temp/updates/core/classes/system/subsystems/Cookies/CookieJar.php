<?php
 namespace UmiCms\System\Cookies;use UmiCms\System\Request\Http\iCookies;use UmiCms\System\Protection\iEncrypter;use UmiCms\System\Session\iSession;class CookieJar implements iCookieJar {private $factory;private $response;private $request;private $cryptographer;private $options;public function __construct(   iFactory $v9549dd6065d019211460c59a86dd6536,   iResponsePool $v0a8e365f8287aea4afa7cd5a5b6a62f7,   iCookies $v37c772d5b63efa59028ba788d08c4086,   iEncrypter $ve700af1332ed9aa14f321e194cd8c925,   iOptions $v93da65a9fd0004d9477aeac024e08e15  ) {$this->factory = $v9549dd6065d019211460c59a86dd6536;$this->response = $v0a8e365f8287aea4afa7cd5a5b6a62f7;$this->request = $v37c772d5b63efa59028ba788d08c4086;$this->cryptographer = $ve700af1332ed9aa14f321e194cd8c925;$this->options = $v93da65a9fd0004d9477aeac024e08e15;}public function get($vb068931cc450442b63f5b3d276ea4297) {return $this->getRequest()    ->get($vb068931cc450442b63f5b3d276ea4297);}public function getDecrypted($vb068931cc450442b63f5b3d276ea4297) {$v2063c1608d6e0baf80249c42e2be5804 = (string) $this->getRequest()    ->get($vb068931cc450442b63f5b3d276ea4297);if (!isEmptyString($v2063c1608d6e0baf80249c42e2be5804)) {return $this->getEncrypter()     ->decrypt($v2063c1608d6e0baf80249c42e2be5804);}return $v2063c1608d6e0baf80249c42e2be5804 ?: null;}public function set($vb068931cc450442b63f5b3d276ea4297, $v2063c1608d6e0baf80249c42e2be5804 = '', $v2f95ade469f47d6c820ab7bc90882223 = 0) {$v2dccd1ab3e03990aea77359831c85ca2 = $this->getFactory()    ->create($vb068931cc450442b63f5b3d276ea4297, $v2063c1608d6e0baf80249c42e2be5804, $v2f95ade469f47d6c820ab7bc90882223);$this->getResponsePool()    ->push($v2dccd1ab3e03990aea77359831c85ca2);$this->getRequest()    ->set($vb068931cc450442b63f5b3d276ea4297, $v2063c1608d6e0baf80249c42e2be5804);return $v2dccd1ab3e03990aea77359831c85ca2;}public function setEncrypted($vb068931cc450442b63f5b3d276ea4297, $v2063c1608d6e0baf80249c42e2be5804 = '', $v2f95ade469f47d6c820ab7bc90882223 = 0) {$v2063c1608d6e0baf80249c42e2be5804 = (string) $v2063c1608d6e0baf80249c42e2be5804;if (!isEmptyString($v2063c1608d6e0baf80249c42e2be5804)) {$v2063c1608d6e0baf80249c42e2be5804 = $this->getEncrypter()     ->encrypt($v2063c1608d6e0baf80249c42e2be5804);}return $this->set($vb068931cc450442b63f5b3d276ea4297, $v2063c1608d6e0baf80249c42e2be5804, $v2f95ade469f47d6c820ab7bc90882223);}public function setFromHeader($v099fb995346f31c749f6e40db0f395e3) {$v2dccd1ab3e03990aea77359831c85ca2 = $this->getFactory()    ->createFromHeader($v099fb995346f31c749f6e40db0f395e3);$this->getResponsePool()    ->push($v2dccd1ab3e03990aea77359831c85ca2);$this->getRequest()    ->set($v2dccd1ab3e03990aea77359831c85ca2->getName(), $v2dccd1ab3e03990aea77359831c85ca2->getValue());return $v2dccd1ab3e03990aea77359831c85ca2;}public function isExists($vb068931cc450442b63f5b3d276ea4297) {return $this->getRequest()    ->isExist($vb068931cc450442b63f5b3d276ea4297);}public function remove($vb068931cc450442b63f5b3d276ea4297) {$this->getRequest()    ->del($vb068931cc450442b63f5b3d276ea4297);$v2dccd1ab3e03990aea77359831c85ca2 = $this->getResponsePool()    ->pull($vb068931cc450442b63f5b3d276ea4297);$va78ec5601f79e10ffb41f4d121a4edff = time() - 3600;if ($v2dccd1ab3e03990aea77359831c85ca2 instanceof iCookie) {$v2dccd1ab3e03990aea77359831c85ca2->setExpirationTime($va78ec5601f79e10ffb41f4d121a4edff);}else {$v2dccd1ab3e03990aea77359831c85ca2 = $this->getFactory()     ->create($vb068931cc450442b63f5b3d276ea4297, '', $va78ec5601f79e10ffb41f4d121a4edff);}$this->getResponsePool()    ->push($v2dccd1ab3e03990aea77359831c85ca2);return $this;}public function getSessionOptions(iSession $v21d6f40cfb511982e4424e0e250a9557) : array {$v93da65a9fd0004d9477aeac024e08e15 = $this->options->getDefault($v21d6f40cfb511982e4424e0e250a9557);try {$this->initDefaultOptions($v93da65a9fd0004d9477aeac024e08e15);}catch (\wrongParamException $v42552b1f133f9f8eb406d4f306ea9fd1) {\umiExceptionHandler::report($v42552b1f133f9f8eb406d4f306ea9fd1);}return $v93da65a9fd0004d9477aeac024e08e15;}public function getCookieOptions(iCookie $v2dccd1ab3e03990aea77359831c85ca2) : array {return $this->options->getCustom($v2dccd1ab3e03990aea77359831c85ca2);}public function getResponsePool() {return $this->response;}private function initDefaultOptions(array $v93da65a9fd0004d9477aeac024e08e15) : iCookieJar {if (array_key_exists('path', $v93da65a9fd0004d9477aeac024e08e15)) {$this->factory->setPath($v93da65a9fd0004d9477aeac024e08e15['path']);}if (array_key_exists('domain', $v93da65a9fd0004d9477aeac024e08e15)) {$this->factory->setDomain($v93da65a9fd0004d9477aeac024e08e15['domain']);}if (array_key_exists('secure', $v93da65a9fd0004d9477aeac024e08e15)) {$this->factory->setSecureFlag($v93da65a9fd0004d9477aeac024e08e15['secure']);if ($v93da65a9fd0004d9477aeac024e08e15['secure'] && array_key_exists('samesite', $v93da65a9fd0004d9477aeac024e08e15)) {$this->factory->setSameSite($v93da65a9fd0004d9477aeac024e08e15['samesite']);}}if (array_key_exists('httponly', $v93da65a9fd0004d9477aeac024e08e15)) {$this->factory->setHttpOnlyFlag($v93da65a9fd0004d9477aeac024e08e15['httponly']);}return $this;}private function getFactory() {return $this->factory;}private function getRequest() {return $this->request;}private function getEncrypter() {return $this->cryptographer;}}