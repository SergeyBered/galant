<?php
 namespace UmiCms\System\Data\Object\Property\Value;class MultipleFile extends \umiObjectPropertyFile {protected function loadValue() {$v0fea6a13c52b4d4725368f24b045ca84 = $this->getPropData();if (isset($v0fea6a13c52b4d4725368f24b045ca84['file_val']) && !isEmptyArray($v0fea6a13c52b4d4725368f24b045ca84['file_val'])) {return $this->getFromCache($v0fea6a13c52b4d4725368f24b045ca84['file_val']);}$v80071f37861c360a27b7327e132c911a = $this->getTableName();$v16b2b26000987faccb260b9d39df1269 = (int) $this->getObjectId();$v945100186b119048837b9859c2c46410 = (int) $this->getFieldId();$vef5714e0519bfaa645cdff7d28843b70 = <<<SQL
	SELECT `id`, `src`, `title`, `ord`
	FROM `$v80071f37861c360a27b7327e132c911a`
	WHERE `obj_id` = $v16b2b26000987faccb260b9d39df1269 AND `field_id` = $v945100186b119048837b9859c2c46410;
SQL;   $v0ed50ea17be70d18270742fa3d77b17e = $this->getConnection()    ->queryResult($vef5714e0519bfaa645cdff7d28843b70);$v0ed50ea17be70d18270742fa3d77b17e->setFetchType(\IQueryResult::FETCH_ASSOC);if ($v0ed50ea17be70d18270742fa3d77b17e->length() === 0) {return [];}$vd97a187384fb2a6e45703dfaee973d62 = [];foreach ($v0ed50ea17be70d18270742fa3d77b17e as $vf1965a857bc285d26fe22023aa5ab50d) {$v8c7dd922ad47494fc02c388e12c00eac = $this->mapFile($vf1965a857bc285d26fe22023aa5ab50d);$vd97a187384fb2a6e45703dfaee973d62[$v8c7dd922ad47494fc02c388e12c00eac->getFilePath()] = $v8c7dd922ad47494fc02c388e12c00eac;}$vd97a187384fb2a6e45703dfaee973d62 = $this->filterBrokenFiles($vd97a187384fb2a6e45703dfaee973d62);return $this->sortFileList($vd97a187384fb2a6e45703dfaee973d62);}protected function getFromCache(array $v0fea6a13c52b4d4725368f24b045ca84) {return $this->sortFileList(parent::getFromCache($v0fea6a13c52b4d4725368f24b045ca84));}protected function saveValue() {$this->deleteCurrentRows();if (!is_array($this->value)) {return;}$vef019cabbf54484ac8984054c6fe670b = array_filter($this->value, function ($v2063c1608d6e0baf80249c42e2be5804) {return ($v2063c1608d6e0baf80249c42e2be5804 instanceof \iUmiFile && !$v2063c1608d6e0baf80249c42e2be5804->getIsBroken());});if (isEmptyArray($vef019cabbf54484ac8984054c6fe670b)) {return;}$v80071f37861c360a27b7327e132c911a = $this->getTableName();$v1b1cc7f086b3f074da452bc3129981eb = <<<SQL
INSERT INTO `$v80071f37861c360a27b7327e132c911a` (`obj_id`, `field_id`, `src`, `title`, `ord`) VALUES
SQL;   $v16b2b26000987faccb260b9d39df1269 = (int) $this->getObjectId();$v945100186b119048837b9859c2c46410 = (int) $this->getFieldId();$v4717d53ebfdfea8477f780ec66151dcb = $this->getConnection();foreach ($vef019cabbf54484ac8984054c6fe670b as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {$v25d902c24283ab8cfbac54dfa101ad31 = $v4717d53ebfdfea8477f780ec66151dcb->escape('.' . $v2063c1608d6e0baf80249c42e2be5804->getFilePath(true));$v8bef1cc20ada3bef55fdf132cb2a1cb9 = (int) $v2063c1608d6e0baf80249c42e2be5804->getOrder() ?: $this->getMaxOrder() + 1;$vd5d3db1765287eef77d7927cc956f50a = $v4717d53ebfdfea8477f780ec66151dcb->escape($v2063c1608d6e0baf80249c42e2be5804->getTitle());$v1b1cc7f086b3f074da452bc3129981eb .= sprintf("(%d, %d, '%s', '%s', %d),", $v16b2b26000987faccb260b9d39df1269, $v945100186b119048837b9859c2c46410, $v25d902c24283ab8cfbac54dfa101ad31, $vd5d3db1765287eef77d7927cc956f50a, $v8bef1cc20ada3bef55fdf132cb2a1cb9);}$v1b1cc7f086b3f074da452bc3129981eb = rtrim($v1b1cc7f086b3f074da452bc3129981eb, ',') . ';';$v4717d53ebfdfea8477f780ec66151dcb->query($v1b1cc7f086b3f074da452bc3129981eb);}protected function isNeedToSave(array $v7f7cfde5ec586119b48911a2c75851e5) {$v6f0d192417e46eb424a7f99546f2fbda = $this->value;if (umiCount($v7f7cfde5ec586119b48911a2c75851e5) !== umiCount($v6f0d192417e46eb424a7f99546f2fbda)) {return true;}$vbc18a572fc42bfa0b5ac7af477a6d076 = [];foreach ($v6f0d192417e46eb424a7f99546f2fbda as $v0382b9fd9ef50b6a335f35e0aaaebf99) {$vbc18a572fc42bfa0b5ac7af477a6d076[$v0382b9fd9ef50b6a335f35e0aaaebf99->getFilePath()] = $v0382b9fd9ef50b6a335f35e0aaaebf99;$vbc18a572fc42bfa0b5ac7af477a6d076[$v0382b9fd9ef50b6a335f35e0aaaebf99->getFilePath(true)] = $v0382b9fd9ef50b6a335f35e0aaaebf99;}foreach ($v7f7cfde5ec586119b48911a2c75851e5 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {if (!$v2063c1608d6e0baf80249c42e2be5804 instanceof \iUmiFile) {continue;}if (isset($vbc18a572fc42bfa0b5ac7af477a6d076[$v2063c1608d6e0baf80249c42e2be5804->getFilePath()])) {$v0382b9fd9ef50b6a335f35e0aaaebf99 = $vbc18a572fc42bfa0b5ac7af477a6d076[$v2063c1608d6e0baf80249c42e2be5804->getFilePath()];}else {return true;}if ($v2063c1608d6e0baf80249c42e2be5804->getFilePath() !== $v0382b9fd9ef50b6a335f35e0aaaebf99->getFilePath()) {return true;}if ($v2063c1608d6e0baf80249c42e2be5804->getTitle() !== $v0382b9fd9ef50b6a335f35e0aaaebf99->getTitle()) {return true;}if ($v2063c1608d6e0baf80249c42e2be5804->getOrder() !== $v0382b9fd9ef50b6a335f35e0aaaebf99->getOrder()) {return true;}}return false;}}