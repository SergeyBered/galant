<?php
 namespace UmiCms\System\Protection\Jwt;use UmiCms\System\Patterns\ArrayContainer;class Token extends ArrayContainer implements iToken {private $privateKey;public function setPrivateKey(string $v3c6e0b8a9c15224a8228b9a98ca1531d) : iToken {$this->privateKey = $v3c6e0b8a9c15224a8228b9a98ca1531d;return $this;}public function getValue() : string {return $this->concat([    $this->getHeader(),    $this->getPayload(),    $this->getSignature()   ]);}private function getHeader() : string {return $this->encode(json_encode([    'alg' => 'RS256',    'typ' => 'JWT'   ]));}private function getPayload() : string {return $this->encode(json_encode($this->getArrayCopy()));}private function getSignature() : string {$v8d777f385d3dfec8815d20f7496026dc = $this->concat([    $this->getHeader(),    $this->getPayload(),   ]);$v986c01585f3a1df83c15e6ecf73672ed = '';$vbd0c8e3bd998a500b0984584a7245ca0 = $this->getPrivateKey();if (!openssl_sign($v8d777f385d3dfec8815d20f7496026dc, $v986c01585f3a1df83c15e6ecf73672ed, $vbd0c8e3bd998a500b0984584a7245ca0, 'SHA256')) {throw new \ErrorException(getLabel('label-error-bad-private-key'));}return $this->encode($v986c01585f3a1df83c15e6ecf73672ed);}private function encode(string $vb45cffe084dd3d20d928bee85e7b0f21) : string  {return base64_encode($vb45cffe084dd3d20d928bee85e7b0f21);}private function concat(array $vf1f713c9e000f5d3f280adbd124df4f5) : string {return implode('.', $vf1f713c9e000f5d3f280adbd124df4f5);}private function getPrivateKey() : string {if (!$this->privateKey) {throw new \ErrorException('Google service account private key expected');}return $this->privateKey;}}