<?php
 use UmiCms\Service;use UmiCms\Classes\System\Utils\I18n\I18nFilesLoader;use UmiCms\System\Templater\AdminTemplater;class cmsController extends singleton implements iSingleton, iCmsController {public static $IGNORE_MICROCACHE = false;public $isContentMode = false;public $parsedContent = false;public $currentTitle = false;public $currentHeader = false;public $currentMetaKeywords = false;public $currentMetaDescription = false;public $currentEditElementId = false;public $pre_lang;public $langs_export = [];public $errorUrl;public $headerLabel = false;protected $current_templater = false;protected $currentTemplate;protected $modules = [];protected $current_module = false;protected $current_method = false;protected $current_element_id = false;protected $calculated_referer_uri = false;protected $modulesPath;protected $url_prefix = '';protected $adminDataSet = [];private $skipExecuteMethods = [   'eshop/compare',   'faq/question',   'faq/project',   'faq/category',   'blogs20/blog',   'blogs20/post',   'blogs20/postEdit',   'catalog/category',   'catalog/getObjectsList',   'catalog/object',   'catalog/viewObject',   'catalog/search',   'content/content',   'content/sitemap',   'dispatches/unsubscribe',   'dispatches/subscribe',   'dispatches/subscribe_do',   'emarket/compare',   'emarket/order',   'emarket/purchase',   'filemanager/shared_file',   'forum/confs_list',   'forum/conf',   'forum/topic',   'forum/topic_last_message',   'forum/conf_last_message',   'news/lastlist',   'news/rubric',   'news/view',   'news/related_links',   'news/item',   'news/listlents',   'news/lastlents',   'photoalbum/album',   'photoalbum/photo',   'search/search_do',   'search/suggestions',   'users/settings',   'users/registrate',   'users/registrate_done',   'users/activate',   'users/auth',   'vote/poll',   'vote/insertvote',   'vote/results',   'webforms/page',   'webforms/posted'  ];private $langConstantList = [];public $langs = [];protected function __construct() {$this->modulesPath = SYS_MODULES_PATH;$this->errorUrl = getServer('HTTP_REFERER');}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = null) {return parent::getInstance(__CLASS__);}public function getModule($v52a43e48ec4649dee819dadabcab1bde, $vbd354405a20aa635025421c9edb5d41d = false) {if (!$v52a43e48ec4649dee819dadabcab1bde) {return false;}if (array_key_exists($v52a43e48ec4649dee819dadabcab1bde, $this->modules) && !$vbd354405a20aa635025421c9edb5d41d) {return $this->modules[$v52a43e48ec4649dee819dadabcab1bde];}return $this->loadModule($v52a43e48ec4649dee819dadabcab1bde);}public function getModulesList() {$v10ae9fc7d453b0dd525d0edf2ede7961 = Service::Registry()->getList('//modules');$result = [];foreach ($v10ae9fc7d453b0dd525d0edf2ede7961 as $v47c80780ab608cc046f2a6e6f071feb6) {$result[] = getArrayKey($v47c80780ab608cc046f2a6e6f071feb6, 0);}return $result;}public function isModule($v52a43e48ec4649dee819dadabcab1bde) {return Service::Registry()->contains("//modules/{$v52a43e48ec4649dee819dadabcab1bde}");}public function installModule($v8e74155194666debb2f773d1de2ae7fe) {$INFO = [];$COMPONENTS = [];if (!file_exists($v8e74155194666debb2f773d1de2ae7fe)) {throw new publicAdminException(getLabel('label-errors-13052'), 13052);}require_once $v8e74155194666debb2f773d1de2ae7fe;$vab8a0f7d0c92ada791303247020c58dd = null;if (preg_match('|classes\/modules\/(\S+)\/|i', $v8e74155194666debb2f773d1de2ae7fe, $v9c28d32df234037773be184dbdafc274)) {$vab8a0f7d0c92ada791303247020c58dd = $v9c28d32df234037773be184dbdafc274[1];}if ($vab8a0f7d0c92ada791303247020c58dd === null && preg_match('|classes\/components\/(\S+)\/|i', $v8e74155194666debb2f773d1de2ae7fe, $v9c28d32df234037773be184dbdafc274)) {$vab8a0f7d0c92ada791303247020c58dd = $v9c28d32df234037773be184dbdafc274[1];}if ($vab8a0f7d0c92ada791303247020c58dd != $INFO['name']) {throw new publicAdminException(getLabel('label-errors-13053'), 13053);}$this->checkModuleByName($vab8a0f7d0c92ada791303247020c58dd);$this->checkModuleComponents($COMPONENTS);def_module::install($INFO);}public function getCurrentModule() {return $this->current_module;}public function setCurrentModule($v52a43e48ec4649dee819dadabcab1bde) {$this->current_module = (string) $v52a43e48ec4649dee819dadabcab1bde;return $this;}public function getCurrentMethod() {return $this->current_method;}public function setCurrentMethod($vddaa6e8c8c412299272e183087b8f7b6) {$v2f3a4fccca6406e35bcf33e92dd93135 = [    '__construct',    '__destruct',    '__call',    '__callStatic',    '__get',    '__set',    '__isset',    '__unset',    '__sleep',    '__wakeup',    '__toString',    '__invoke',    '__set_state',    '__clone'   ];if (in_array($vddaa6e8c8c412299272e183087b8f7b6, $v2f3a4fccca6406e35bcf33e92dd93135)) {$this->setCurrentModule('content');$vddaa6e8c8c412299272e183087b8f7b6 = 'notfound';}$this->current_method = (string) $vddaa6e8c8c412299272e183087b8f7b6;return $this;}public function getCurrentElementId() {return $this->current_element_id;}public function setCurrentElementId($vb80bb7740288fda1f201890375a60c8f) {$this->current_element_id = $vb80bb7740288fda1f201890375a60c8f;return $this;}public function getCurrentTemplater($v2d101d1f0f03caaff97e0cebe2a51896 = false) {if (!$this->current_templater instanceof umiTemplater || $v2d101d1f0f03caaff97e0cebe2a51896) {$this->detectCurrentTemplater();}if (!$this->current_templater instanceof umiTemplater) {throw new coreException("Can't detect current templater.");}return $this->current_templater;}public function getLangConstantList() {if (empty($this->langConstantList)) {$this->langConstantList = $this->loadLangConstantList();}return $this->langConstantList;}public function setLangConstant($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, $vd304ba20e96d87411588eeabac850e34) {$this->langConstantList[$v22884db148f0ffb0d830ba431102b0b5][$vea9f6aca279138c58f705c8d4cb4b8ce] = $vd304ba20e96d87411588eeabac850e34;return $this;}public function getResourcesDirectory($v64feae0988f5b61c96c305e3c3f04551 = false) {$va0f97308110b5ffc40d784efae2257bb = $this->getCurrentDesignTemplate();return ($va0f97308110b5ffc40d784efae2257bb instanceof iTemplate)    ? $va0f97308110b5ffc40d784efae2257bb->getResourcesDirectory($v64feae0988f5b61c96c305e3c3f04551)    : false;}public function getTemplatesDirectory() {$v66f6181bcb4cff4cd38fbc804a036db6 = $this->detectCurrentDesignTemplate();if ($v66f6181bcb4cff4cd38fbc804a036db6 instanceof iTemplate) {return $v66f6181bcb4cff4cd38fbc804a036db6->getTemplatesDirectory();}return CURRENT_WORKING_DIR . 'xsltTpls/';}public function getGlobalVariables($v2d4260a0fcf0c77266e1b8f41bd4080c = false) {static $v6d9fecd2868e8a635b6d088c3e8068c2;if (!$v2d4260a0fcf0c77266e1b8f41bd4080c && $v6d9fecd2868e8a635b6d088c3e8068c2 !== null) {return $v6d9fecd2868e8a635b6d088c3e8068c2;}$v6d9fecd2868e8a635b6d088c3e8068c2 = [];switch (true) {case (Service::Request()->isAdmin()) : {$v6d9fecd2868e8a635b6d088c3e8068c2 = $this->prepareAdminSideGlobalVariables();break;}case (def_module::isXSLTResultMode()) : {$v6d9fecd2868e8a635b6d088c3e8068c2 = $this->prepareClientSideGlobalVariablesForXSLT();break;}default: {$v6d9fecd2868e8a635b6d088c3e8068c2 = $this->prepareClientSideGlobalVariablesForTPL();}}$v70e8822b2e035fa3777d666207aeafa8 = new umiEventPoint('globalVariablesCollected');$v70e8822b2e035fa3777d666207aeafa8->setMode('after');$v70e8822b2e035fa3777d666207aeafa8->addRef('variables', $v6d9fecd2868e8a635b6d088c3e8068c2);$v70e8822b2e035fa3777d666207aeafa8->call();return $v6d9fecd2868e8a635b6d088c3e8068c2;}public function executeStream($v9305b73d359bd06734fee0b3638079e1) {if (($v8d777f385d3dfec8815d20f7496026dc = @file_get_contents($v9305b73d359bd06734fee0b3638079e1)) === false) {$v9305b73d359bd06734fee0b3638079e1 .= (!contains($v9305b73d359bd06734fee0b3638079e1, '?')) ? '?umiHash=' : '&umiHash=';$v9305b73d359bd06734fee0b3638079e1 .= md5($v9305b73d359bd06734fee0b3638079e1);if (($v8d777f385d3dfec8815d20f7496026dc = @file_get_contents($v9305b73d359bd06734fee0b3638079e1)) === false) {preg_match("/(\w+:\/\/)/i", $v9305b73d359bd06734fee0b3638079e1, $v9c28d32df234037773be184dbdafc274);$vf7b44cfafd5c52223d5498196c8a2e7b = $v9c28d32df234037773be184dbdafc274[1];throw new coreException("Failed to open $vf7b44cfafd5c52223d5498196c8a2e7b stream");}}return $v8d777f385d3dfec8815d20f7496026dc;}public function isAllowedExecuteMethod($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce) {return !in_array($v22884db148f0ffb0d830ba431102b0b5 . '/' . $vea9f6aca279138c58f705c8d4cb4b8ce, $this->skipExecuteMethods);}public function getCurrentTemplate() {if (!$this->currentTemplate) {$this->detectCurrentDesignTemplate();}return $this->currentTemplate;}public function isVirtualModule($v52a43e48ec4649dee819dadabcab1bde) {return in_array($v52a43e48ec4649dee819dadabcab1bde, iCmsController::VIRTUAL_MODULE_LIST);}public function detectCurrentDesignTemplate() {$v65ac1f4cfaa18bd14546f2c5a7d2ad80 = templatesCollection::getInstance();$v66f6181bcb4cff4cd38fbc804a036db6 = null;$v3200a31fc05da4e9d5a0465c36822e2f = (int) getRequest('template_id');if ($v3200a31fc05da4e9d5a0465c36822e2f) {$v66f6181bcb4cff4cd38fbc804a036db6 = $v65ac1f4cfaa18bd14546f2c5a7d2ad80->getTemplate($v3200a31fc05da4e9d5a0465c36822e2f);}if (!$v66f6181bcb4cff4cd38fbc804a036db6 instanceof iTemplate) {$v66f6181bcb4cff4cd38fbc804a036db6 = $v65ac1f4cfaa18bd14546f2c5a7d2ad80->getCurrentTemplate();}$this->currentTemplate = $v66f6181bcb4cff4cd38fbc804a036db6;return $v66f6181bcb4cff4cd38fbc804a036db6;}public function analyzePath($v86266ee937d97f812a8e57d22b62ee29 = false) {$v10573b873d2fa5a365d558a45e328e47 = Service::Request();$vb6ee27ee7fe19b0c0dd907d5f947aa12 = $v10573b873d2fa5a365d558a45e328e47->uri();if ($vb6ee27ee7fe19b0c0dd907d5f947aa12 && !$this->isCorrectRequestUri($vb6ee27ee7fe19b0c0dd907d5f947aa12)) {$this->setNotFoundState();return;}$vd6fe1d0be6347b8ef2427fa629c04485 = $v10573b873d2fa5a365d558a45e328e47->getCleanPath();$v41323917ef8089432959a3c33269debf = $v10573b873d2fa5a365d558a45e328e47->getStreamScheme();if ($v41323917ef8089432959a3c33269debf !== null) {if (preg_replace('/[^\w]/im', '', $v41323917ef8089432959a3c33269debf) == 'upage') {preg_match_all('/[\d]+/', $vd6fe1d0be6347b8ef2427fa629c04485, $v7552cd149af7495ee7d8225974e50f80);if (isset($v7552cd149af7495ee7d8225974e50f80[0][0])) {$this->setCurrentElementId($v7552cd149af7495ee7d8225974e50f80[0][0]);}}return;}$vb1444fb0c07653567ad325aa25d4e37a = Service::Registry();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$v7f2db423a49b305459147332fb01cf87 = Service::Response()    ->getCurrentBuffer();$v2d8413ae32cda5259e93d4f3666f1235 = Service::Redirects();if ($v86266ee937d97f812a8e57d22b62ee29 === true) {$this->reset();}$v5f44c555cfb3ecb28f624fa95617f277 = $v2245023265ae4cf87d02c8b6ba991139->get('seo', 'url-suffix');$v5e0bdcbddccca4d66d74ba8c1cee1a68 = mb_strrpos($vd6fe1d0be6347b8ef2427fa629c04485, $v5f44c555cfb3ecb28f624fa95617f277);if ($v5e0bdcbddccca4d66d74ba8c1cee1a68 && ($v5e0bdcbddccca4d66d74ba8c1cee1a68 + mb_strlen($v5f44c555cfb3ecb28f624fa95617f277) == mb_strlen($vd6fe1d0be6347b8ef2427fa629c04485))) {$vd6fe1d0be6347b8ef2427fa629c04485 = mb_substr($vd6fe1d0be6347b8ef2427fa629c04485, 0, $v5e0bdcbddccca4d66d74ba8c1cee1a68);}if ($v10573b873d2fa5a365d558a45e328e47->isNotAdmin()) {$v2d8413ae32cda5259e93d4f3666f1235->redirectIfRequired($vb6ee27ee7fe19b0c0dd907d5f947aa12, true);}if ($v2245023265ae4cf87d02c8b6ba991139->get('seo', 'watch-redirects-history')) {$v2d8413ae32cda5259e93d4f3666f1235->init();}$v1af4d7e444526825e8273a27c76ccc15 = $v10573b873d2fa5a365d558a45e328e47->getCleanPathParts();$v7dabf5c198b0bab2eaa42bb03a113e55 = umiCount($v1af4d7e444526825e8273a27c76ccc15);$vfbd6d3bc6d9b383e6f427016a01082cb = [];$v83878c91171338902e0fe0fb97a8c47a = 0;$v6260204e62537354783e453ec069a046 = Service::LanguageDetector()->detect();for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v1634b7ef7a71f9ae79c4b3b3badd71a0 = $v1af4d7e444526825e8273a27c76ccc15[$v865c0c0b4ab0e063e5caa3387c1a8741];if ($v865c0c0b4ab0e063e5caa3387c1a8741 <= 1) {if (($v1634b7ef7a71f9ae79c4b3b3badd71a0 == $v10573b873d2fa5a365d558a45e328e47->mode()) || ($v1634b7ef7a71f9ae79c4b3b3badd71a0 == $v6260204e62537354783e453ec069a046->getPrefix())) {continue;}}$vfbd6d3bc6d9b383e6f427016a01082cb[] = $v1634b7ef7a71f9ae79c4b3b3badd71a0;$v1f43049ea0e20666083161da84dfb54e = $this->getSubPathType($v1634b7ef7a71f9ae79c4b3b3badd71a0);if ($v1f43049ea0e20666083161da84dfb54e == 'PARAM') {$_REQUEST['param' . $v83878c91171338902e0fe0fb97a8c47a++] = $v1634b7ef7a71f9ae79c4b3b3badd71a0;}}if (!$this->getCurrentModule()) {if ($v10573b873d2fa5a365d558a45e328e47->isAdmin()) {if ($vb1444fb0c07653567ad325aa25d4e37a->get('//settings/default_module_admin_changed') ||      !$v52a43e48ec4649dee819dadabcab1bde = $vb1444fb0c07653567ad325aa25d4e37a->get('//modules/events')) {$v52a43e48ec4649dee819dadabcab1bde = $vb1444fb0c07653567ad325aa25d4e37a->get('//settings/default_module_admin');}else {$v52a43e48ec4649dee819dadabcab1bde = $vb1444fb0c07653567ad325aa25d4e37a->get('//modules/events');}$this->autoRedirectToMethod($v52a43e48ec4649dee819dadabcab1bde);}else {$v52a43e48ec4649dee819dadabcab1bde = $vb1444fb0c07653567ad325aa25d4e37a->get('//settings/default_module');}$this->setCurrentModule($v52a43e48ec4649dee819dadabcab1bde);}if (!$this->getCurrentMethod()) {if ($v10573b873d2fa5a365d558a45e328e47->isAdmin()) {return $this->autoRedirectToMethod($this->getCurrentModule());}$v2fa70149e2a7e75da2b0303d0a36a944 = $vb1444fb0c07653567ad325aa25d4e37a->get('//modules/' . $this->getCurrentModule() . '/default_method');$this->setCurrentMethod($v2fa70149e2a7e75da2b0303d0a36a944);}if ($v10573b873d2fa5a365d558a45e328e47->isAdmin()) {return;}$v7552cd149af7495ee7d8225974e50f80 = false;$v7dabf5c198b0bab2eaa42bb03a113e55 = umiCount($vfbd6d3bc6d9b383e6f427016a01082cb);$v1634b7ef7a71f9ae79c4b3b3badd71a0 = '';$v5f51e765b4dc9821bb184fe18370ab8d = 0;$v72ee76c5c29383b7c9f9225c1fa4d10b = false;$vf585b7f018bb4ced15a03683a733e50b = false;$v9169f09d18276d0619f45e741c3c1ea6 = true;for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v1634b7ef7a71f9ae79c4b3b3badd71a0 .= '/' . $vfbd6d3bc6d9b383e6f427016a01082cb[$v865c0c0b4ab0e063e5caa3387c1a8741];if (!($vfa816edb83e95bf0c8da580bdfd491ef = $vb81ca7c0ccaa77e7aa91936ab0070695->getIdByPath(     $v1634b7ef7a71f9ae79c4b3b3badd71a0, false, $v5f51e765b4dc9821bb184fe18370ab8d, $v72ee76c5c29383b7c9f9225c1fa4d10b, $vf585b7f018bb4ced15a03683a733e50b, $v9169f09d18276d0619f45e741c3c1ea6    ))) {$v7552cd149af7495ee7d8225974e50f80 = false;break;}$v7552cd149af7495ee7d8225974e50f80 = $vfa816edb83e95bf0c8da580bdfd491ef;}if ($v7552cd149af7495ee7d8225974e50f80) {$v5cd943c36b800237522c35155d898244 = false;$vbc9ecd0be77ceffa51fc6918c714e5d3 = false;$vece42746c2b3aa1e585809fa739602ae = false;$vbddb263f3f2e04e36c5d07d938f2818f = false;if ($this->isCaseSensitiveAltName() && $v10573b873d2fa5a365d558a45e328e47->isHtml()) {$v44febe2beadd1d4b691811c127575d70 = Service::UrlFactory();$v9790bd2d615d9f9ef746ca3da275b4e8 = $v44febe2beadd1d4b691811c127575d70->create($vb81ca7c0ccaa77e7aa91936ab0070695->getPathById(      $v7552cd149af7495ee7d8225974e50f80, $v5cd943c36b800237522c35155d898244, $vbc9ecd0be77ceffa51fc6918c714e5d3, $vece42746c2b3aa1e585809fa739602ae, $vbddb263f3f2e04e36c5d07d938f2818f, $v9169f09d18276d0619f45e741c3c1ea6     ));$v6a6524f1269ef3af3f9a045687177e04 = $v44febe2beadd1d4b691811c127575d70->create($vb6ee27ee7fe19b0c0dd907d5f947aa12);if ($v9790bd2d615d9f9ef746ca3da275b4e8->getPath() !== $this->addSuffixToPath($v6a6524f1269ef3af3f9a045687177e04->getPath())) {$vd6fe1d0be6347b8ef2427fa629c04485 = $v6a6524f1269ef3af3f9a045687177e04->merge($v9790bd2d615d9f9ef746ca3da275b4e8);$this->processCaseSensitiveUrl($v7f2db423a49b305459147332fb01cf87, $vd6fe1d0be6347b8ef2427fa629c04485);$v7552cd149af7495ee7d8225974e50f80 = false;}}if ($v5f51e765b4dc9821bb184fe18370ab8d > 0 && !defined('DISABLE_AUTOCORRECTION_REDIRECT')) {$vd6fe1d0be6347b8ef2427fa629c04485 = $vb81ca7c0ccaa77e7aa91936ab0070695->getPathById(      $v7552cd149af7495ee7d8225974e50f80, $v5cd943c36b800237522c35155d898244, $vbc9ecd0be77ceffa51fc6918c714e5d3, $vece42746c2b3aa1e585809fa739602ae, $vbddb263f3f2e04e36c5d07d938f2818f, $v9169f09d18276d0619f45e741c3c1ea6     );if ($v865c0c0b4ab0e063e5caa3387c1a8741 == 0) {if ($this->isModule($vfbd6d3bc6d9b383e6f427016a01082cb[0])) {$v7552cd149af7495ee7d8225974e50f80 = false;}}$v7f2db423a49b305459147332fb01cf87->status('301 Moved Permanently');$v7f2db423a49b305459147332fb01cf87->redirect($vd6fe1d0be6347b8ef2427fa629c04485);}$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80);if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof iUmiHierarchyElement) {if ($v8e2dcfd7e7e24b1ca76c1193f645902b->getIsDefault()) {$vd6fe1d0be6347b8ef2427fa629c04485 = $vb81ca7c0ccaa77e7aa91936ab0070695->getPathById(       $v7552cd149af7495ee7d8225974e50f80, $v5cd943c36b800237522c35155d898244, $vbc9ecd0be77ceffa51fc6918c714e5d3, $vece42746c2b3aa1e585809fa739602ae, $vbddb263f3f2e04e36c5d07d938f2818f, $v9169f09d18276d0619f45e741c3c1ea6      );$v7f2db423a49b305459147332fb01cf87->status('301 Moved Permanently');$v7f2db423a49b305459147332fb01cf87->redirect($vd6fe1d0be6347b8ef2427fa629c04485);}}}elseif (isset($vfbd6d3bc6d9b383e6f427016a01082cb[0])) {if ($this->isModule($vfbd6d3bc6d9b383e6f427016a01082cb[0])) {$v22884db148f0ffb0d830ba431102b0b5 = $this->getModule($vfbd6d3bc6d9b383e6f427016a01082cb[0]);if (isset($vfbd6d3bc6d9b383e6f427016a01082cb[1]) && !$v22884db148f0ffb0d830ba431102b0b5->isMethodExists($vfbd6d3bc6d9b383e6f427016a01082cb[1])) {$this->setCurrentModule('content');$this->setCurrentMethod('content');}}else {$this->setCurrentModule('content');$this->setCurrentMethod('content');}}if (($vd6fe1d0be6347b8ef2427fa629c04485 == '' || $vd6fe1d0be6347b8ef2427fa629c04485 == $v6260204e62537354783e453ec069a046->getPrefix()) && $v10573b873d2fa5a365d558a45e328e47->isNotAdmin()) {$v7552cd149af7495ee7d8225974e50f80 = $vb81ca7c0ccaa77e7aa91936ab0070695->getDefaultElementId(     $v6260204e62537354783e453ec069a046->getId(),     Service::DomainDetector()->detectId()    );if ($v7552cd149af7495ee7d8225974e50f80) {$this->setCurrentElementId($v7552cd149af7495ee7d8225974e50f80);}else {$this->setCurrentModule('content');$this->setCurrentMethod('content');}}$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80, true);if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof iUmiHierarchyElement) {$v599dcce2998a6b40b1e38e8c6006cb0a = umiHierarchyTypesCollection::getInstance()->getType($v8e2dcfd7e7e24b1ca76c1193f645902b->getTypeId());if (!$v599dcce2998a6b40b1e38e8c6006cb0a || $v599dcce2998a6b40b1e38e8c6006cb0a->hidePages()) {$this->setNotFoundState();return;}$this->setCurrentModule($v599dcce2998a6b40b1e38e8c6006cb0a->getName());$vabf77184f55403d75b9d51d79162a7ca = $v599dcce2998a6b40b1e38e8c6006cb0a->getExt();if ($vabf77184f55403d75b9d51d79162a7ca) {$this->setCurrentMethod($vabf77184f55403d75b9d51d79162a7ca);}else {$this->setCurrentMethod('content');}$this->setCurrentElementId($v7552cd149af7495ee7d8225974e50f80);}if ($this->getCurrentModule() == 'content' && $this->getCurrentMethod() == 'content' && !$v7552cd149af7495ee7d8225974e50f80) {$v2d8413ae32cda5259e93d4f3666f1235->redirectIfRequired($vd6fe1d0be6347b8ef2427fa629c04485);}}private function isCorrectRequestUri($vb6ee27ee7fe19b0c0dd907d5f947aa12) {return !preg_match('/(^[^\?]*\/&)/', $vb6ee27ee7fe19b0c0dd907d5f947aa12);}public function setAdminDataSet($v181746b262df9e42f6016b8637fc8c52) {$this->adminDataSet = $v181746b262df9e42f6016b8637fc8c52;}public function getRequestId() {static $v510ff634fce407eea1763854519fd3ce = false;if ($v510ff634fce407eea1763854519fd3ce === false) {$v510ff634fce407eea1763854519fd3ce = time();}return $v510ff634fce407eea1763854519fd3ce;}public function getPreLang() {if ($this->pre_lang === null) {$this->detectPreLang();}return $this->pre_lang;}public function setPreLang($v851f5ac9941d720844d143ed9cfcf60a) {$this->pre_lang = (string) $v851f5ac9941d720844d143ed9cfcf60a;return $this;}public function calculateRefererUri() {$v21d6f40cfb511982e4424e0e250a9557 = Service::Session();$vcea75f8cd36a4f8567d5068b7e7e05e8 = getRequest('referer');if ($vcea75f8cd36a4f8567d5068b7e7e05e8) {$v21d6f40cfb511982e4424e0e250a9557->set('referer', $vcea75f8cd36a4f8567d5068b7e7e05e8);}else {$vcea75f8cd36a4f8567d5068b7e7e05e8 = $v21d6f40cfb511982e4424e0e250a9557->get('referer');if ($vcea75f8cd36a4f8567d5068b7e7e05e8) {$v21d6f40cfb511982e4424e0e250a9557->del('referer');}else {$vcea75f8cd36a4f8567d5068b7e7e05e8 = getServer('HTTP_REFERER');}}$this->calculated_referer_uri = $vcea75f8cd36a4f8567d5068b7e7e05e8;}public function getCalculatedRefererUri() {if ($this->calculated_referer_uri === false) {$this->calculateRefererUri();}return $this->calculated_referer_uri;}public function setUrlPrefix($v851f5ac9941d720844d143ed9cfcf60a = '') {$this->url_prefix = $v851f5ac9941d720844d143ed9cfcf60a;}public function getUrlPrefix() {return $this->url_prefix ?: '';}protected function autoRedirectToMethod($v52a43e48ec4649dee819dadabcab1bde) {$va9205dcfd4a6f7c2cbe8be01566ff84a = Service::Registry();$permissions = permissionsCollection::getInstance();$v8e44f0089b076e18a718eb9ca3d94674 = Service::Auth()->getUserId();if (!$permissions->isAllowedModule($v8e44f0089b076e18a718eb9ca3d94674, $v52a43e48ec4649dee819dadabcab1bde) || !$v52a43e48ec4649dee819dadabcab1bde) {try {$v52a43e48ec4649dee819dadabcab1bde = $this->getFirstAllowedModuleName();}catch (publicAdminException $v42552b1f133f9f8eb406d4f306ea9fd1) {$v525f24275b9d000f50629f4ff398152c = $this->isModule('events') ? 'events' : 'content';$v52a43e48ec4649dee819dadabcab1bde = $va9205dcfd4a6f7c2cbe8be01566ff84a->get('//settings/default_module_admin') ?: $v525f24275b9d000f50629f4ff398152c;}}$vea9f6aca279138c58f705c8d4cb4b8ce = $va9205dcfd4a6f7c2cbe8be01566ff84a->get('//modules/' . $v52a43e48ec4649dee819dadabcab1bde . '/default_method_admin');if (!$permissions->isAllowedMethod($v8e44f0089b076e18a718eb9ca3d94674, $v52a43e48ec4649dee819dadabcab1bde, $vea9f6aca279138c58f705c8d4cb4b8ce) || !$vea9f6aca279138c58f705c8d4cb4b8ce) {$v22884db148f0ffb0d830ba431102b0b5 = $this->getModule($v52a43e48ec4649dee819dadabcab1bde);if (!$v22884db148f0ffb0d830ba431102b0b5 instanceof def_module) {throw new publicAdminException(getLabel('error-cannot-load-module', false, $v52a43e48ec4649dee819dadabcab1bde));}try {$vea9f6aca279138c58f705c8d4cb4b8ce = $v22884db148f0ffb0d830ba431102b0b5->getFirstAllowedTabName();}catch (publicAdminException $v42552b1f133f9f8eb406d4f306ea9fd1) {}}$v572d4e421e5e6b9bc11d815e8a027112 = $this->getPreLang() . '/admin/' . $v52a43e48ec4649dee819dadabcab1bde . '/' . $vea9f6aca279138c58f705c8d4cb4b8ce . '/';Service::Response()    ->getCurrentBuffer()    ->redirect($v572d4e421e5e6b9bc11d815e8a027112);}public function getFirstAllowedModuleName() {$v3e6d17f66651c4d9e5bed84613507302 = permissionsCollection::getInstance();$v8e44f0089b076e18a718eb9ca3d94674 = Service::Auth()    ->getUserId();foreach ($this->getModulesList() as $v22884db148f0ffb0d830ba431102b0b5) {if ($v3e6d17f66651c4d9e5bed84613507302->isAllowedModule($v8e44f0089b076e18a718eb9ca3d94674, $v22884db148f0ffb0d830ba431102b0b5)) {return $v22884db148f0ffb0d830ba431102b0b5;}}throw new publicAdminException(getLabel('error-cannot-detect-allowed-module'));}public function setNotFoundState() {return $this->setCurrentModule('content')    ->setCurrentMethod('content')    ->setCurrentElementId(false);}public function isNotFoundState() {return $this->getCurrentModule() === 'content' && $this->getCurrentMethod() === 'content' && !$this->getCurrentElementId();}final public static function doSomething() {if (isDemoMode() || isCronCliMode()) {return true;}$v7f2db423a49b305459147332fb01cf87 = Service::Response()    ->getCurrentBuffer();if (defined('CURRENT_VERSION_LINE') && !isDemoMode()) {$v7f2db423a49b305459147332fb01cf87->crash('invalid_license');}if (!is_writable(SYS_CACHE_RUNTIME)) {$v7f2db423a49b305459147332fb01cf87->crash('invalid_permissions');}$v1a54c1036ccb10069e9c06281d52007a = Service::RegistrySettings()->getLicense();if (self::doStrangeThings($v1a54c1036ccb10069e9c06281d52007a)) {return true;}$vdff71ebdd1d2cd4cd12e2eea2893fd84 = [    'pro' => umiTemplater::getSomething('pro'),    'ultimate' => umiTemplater::getSomething('ultimate'),    '1cfranchisee' => umiTemplater::getSomething('1cfranchisee'),    'umifree' => umiTemplater::getSomething('umifree'),    'shop' => umiTemplater::getSomething('shop'),    'lite' => umiTemplater::getSomething('lite'),    'start' => umiTemplater::getSomething('start'),    'trial' => umiTemplater::getSomething('trial')   ];if (regedit::checkSomething($v1a54c1036ccb10069e9c06281d52007a, $vdff71ebdd1d2cd4cd12e2eea2893fd84)) {return true;}$v7f2db423a49b305459147332fb01cf87->crash('invalid_license');}private static function doStrangeThings($v1a54c1036ccb10069e9c06281d52007a) {if (isDemoMode()) {return true;}$v0a7c842c53a6565aeae98fb6ff6b5348 = SYS_CACHE_RUNTIME . 'trash';$vf8df9d3951d8908e1cd5866d10330542 = false;$vcd91e7679d575a2c548bd2c889c23b9e = 604800;if (file_exists($v0a7c842c53a6565aeae98fb6ff6b5348)) {if ((time() - filemtime($v0a7c842c53a6565aeae98fb6ff6b5348)) > $vcd91e7679d575a2c548bd2c889c23b9e) {$vf8df9d3951d8908e1cd5866d10330542 = base64_decode(file_get_contents($v0a7c842c53a6565aeae98fb6ff6b5348));}}else {file_put_contents($v0a7c842c53a6565aeae98fb6ff6b5348, base64_encode($v1a54c1036ccb10069e9c06281d52007a));}if ($vf8df9d3951d8908e1cd5866d10330542 !== false && $v1a54c1036ccb10069e9c06281d52007a) {if ($v1a54c1036ccb10069e9c06281d52007a === $vf8df9d3951d8908e1cd5866d10330542) {return true;}}return true;}private function loadModule($v52a43e48ec4649dee819dadabcab1bde) {if (Service::Registry()->get("//modules/{$v52a43e48ec4649dee819dadabcab1bde}") != $v52a43e48ec4649dee819dadabcab1bde) {return false;}$vc22d45567638173f6f7c953f54077fbd = $this->modulesPath . $v52a43e48ec4649dee819dadabcab1bde . DIRECTORY_SEPARATOR . 'class.php';if (!file_exists($vc22d45567638173f6f7c953f54077fbd)) {return false;}if (!class_exists($v52a43e48ec4649dee819dadabcab1bde)) {require $vc22d45567638173f6f7c953f54077fbd;}$v22884db148f0ffb0d830ba431102b0b5 = new $v52a43e48ec4649dee819dadabcab1bde();$v22884db148f0ffb0d830ba431102b0b5->pre_lang = $this->getPreLang();$v22884db148f0ffb0d830ba431102b0b5->pid = $this->getCurrentElementId();$this->modules[$v52a43e48ec4649dee819dadabcab1bde] = $v22884db148f0ffb0d830ba431102b0b5;return $v22884db148f0ffb0d830ba431102b0b5;}private function checkModuleComponents($v4725dcf446a342f1473a8228e42dfa48) {if (!is_array($v4725dcf446a342f1473a8228e42dfa48)) {return false;}$v45b963397aa40d4a0063e0d85e4fe7a1 = [];foreach ($v4725dcf446a342f1473a8228e42dfa48 as $v700c216fb376666eaeda0c892e8bdc09) {$v8c7dd922ad47494fc02c388e12c00eac = preg_replace('/.\/(.+)/', CURRENT_WORKING_DIR . '/' . '$1', $v700c216fb376666eaeda0c892e8bdc09);if (!file_exists($v8c7dd922ad47494fc02c388e12c00eac) || !is_readable($v8c7dd922ad47494fc02c388e12c00eac)) {$v45b963397aa40d4a0063e0d85e4fe7a1[] = $v8c7dd922ad47494fc02c388e12c00eac;}}if (umiCount($v45b963397aa40d4a0063e0d85e4fe7a1)) {$vcb5e100e5a9a3e7f6d1fd97512215282 = getLabel('label-errors-13058') . "\n";foreach ($v45b963397aa40d4a0063e0d85e4fe7a1 as $v8c7dd922ad47494fc02c388e12c00eac) {$vcb5e100e5a9a3e7f6d1fd97512215282 .= getLabel('error-file-does-not-exist', null, $v8c7dd922ad47494fc02c388e12c00eac) . "\n";}throw new coreException($vcb5e100e5a9a3e7f6d1fd97512215282);}return true;}private function checkModuleByName($v52a43e48ec4649dee819dadabcab1bde) {if (!defined('UPDATE_SERVER')) {define('UPDATE_SERVER', base64_decode('aHR0cDovL3VwZGF0ZXMudW1pLWNtcy5ydS91cGRhdGVzZXJ2ZXIv'));}$vb1444fb0c07653567ad325aa25d4e37a = Service::Registry();$v14a0ffee308315f250f040d5b4d48560 = Service::DomainCollection();$vcaf9b6b99962bf5c2264824231d7a40c = [    'type' => 'get-modules-list',    'revision' => $this->getSystemBuild(),    'host' => $v14a0ffee308315f250f040d5b4d48560->getDefaultDomain()->getHost(),    'ip' => getServer('SERVER_ADDR'),    'key' => Service::RegistrySettings()->getLicense()   ];$v572d4e421e5e6b9bc11d815e8a027112 = UPDATE_SERVER . '?' . http_build_query($vcaf9b6b99962bf5c2264824231d7a40c, '', '&');$result = $this->getFile($v572d4e421e5e6b9bc11d815e8a027112);if (!$result) {throw new publicAdminException(getLabel('label-errors-13054'), 13054);}$v0f635d0e0f3874fff8b581c132e6c7a7 = new DOMDocument();if (!$v0f635d0e0f3874fff8b581c132e6c7a7->loadXML($result)) {throw new publicAdminException(getLabel('label-errors-13055'), 13055);}$v3d788fa62d7c185a1bee4c9147ee1091 = new DOMXPath($v0f635d0e0f3874fff8b581c132e6c7a7);$v07213a0161f52846ab198be103b5ab43 = $v3d788fa62d7c185a1bee4c9147ee1091->query('error');if ($v07213a0161f52846ab198be103b5ab43->length != 0) {$vcb5e100e5a9a3e7f6d1fd97512215282 = $v07213a0161f52846ab198be103b5ab43->item(0);$vc13367945d5d4c91047b3b50234aa7ab = $vcb5e100e5a9a3e7f6d1fd97512215282->getAttribute('code');throw new publicAdminException(getLabel('label-errors-' . $vc13367945d5d4c91047b3b50234aa7ab), $vc13367945d5d4c91047b3b50234aa7ab);}$v0eb9b3af2e4a00837a1b1a854c9ea18c = $v3d788fa62d7c185a1bee4c9147ee1091->query('module');if ($v0eb9b3af2e4a00837a1b1a854c9ea18c->length == 0) {throw new publicAdminException(getLabel('label-errors-13056'), 13056);}$v52a43e48ec4649dee819dadabcab1bde = mb_strtolower($v52a43e48ec4649dee819dadabcab1bde);$v0eb9b3af2e4a00837a1b1a854c9ea18c = $v3d788fa62d7c185a1bee4c9147ee1091->query("module[@name='" . $v52a43e48ec4649dee819dadabcab1bde . "']");if ($v0eb9b3af2e4a00837a1b1a854c9ea18c->length != 0) {$v22884db148f0ffb0d830ba431102b0b5 = $v0eb9b3af2e4a00837a1b1a854c9ea18c->item(0);if ($v22884db148f0ffb0d830ba431102b0b5->getAttribute('active') != '1') {throw new publicAdminException(getLabel('label-errors-13057'), 13057);}}}private function getFile($v572d4e421e5e6b9bc11d815e8a027112) {try {return umiRemoteFileGetter::get($v572d4e421e5e6b9bc11d815e8a027112);}catch (Exception $ve1671797c52e15f763380b45e841ec32) {throw new publicAdminException(getLabel('label-errors-13041'), 13041);}}private function isGateway() {$v15fd82cde2a6c5cde8ab669e8d349305 = [    ['exchange', 'auto'],    ['exchange', 'export1C'],    ['users', 'login_do'],    ['emarket', 'getOrderStatuses'],    ['emarket', 'getOrderStatusesList'],    ['emarket', 'getDeliveryStatuses'],    ['emarket', 'getPaymentStatuses'],    ['emarket', 'getOrdersByStatus'],    ['emarket', 'getOrder'],    ['emarket', 'setOrder'],    ['emarket', 'addToken'],    ['emarket', 'removeToken']   ];$v85bbc13cbb5a7f2e08a4c8d5bac934f3 = mainConfiguration::getInstance()->get('system', 'gateways');if (is_array($v85bbc13cbb5a7f2e08a4c8d5bac934f3)) {foreach ($v85bbc13cbb5a7f2e08a4c8d5bac934f3 as $v33c9b363aa666f43190fa83fce543646) {$v15fd82cde2a6c5cde8ab669e8d349305[] = explode('-', $v33c9b363aa666f43190fa83fce543646);}}$v22884db148f0ffb0d830ba431102b0b5 = $this->getCurrentModule();$vea9f6aca279138c58f705c8d4cb4b8ce = $this->getCurrentMethod();return in_array([$v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce], $v15fd82cde2a6c5cde8ab669e8d349305);}private function prepareAdminSideGlobalVariables() {$vb2767dac3edbe28998ccf00b2b64e303 = false;if (!$this->isGateway() && mb_strtoupper($_SERVER['REQUEST_METHOD']) === 'POST') {$ve91e6348157868de9dd8b25c81aebfb9 = Service::Protection();$ve91e6348157868de9dd8b25c81aebfb9->checkReferrer();try {$ve91e6348157868de9dd8b25c81aebfb9->checkCsrf();}catch (UmiCms\System\Protection\CsrfException $ve1671797c52e15f763380b45e841ec32) {$vb2767dac3edbe28998ccf00b2b64e303 = true;}}$permissions = permissionsCollection::getInstance();$ve4e46deb7f9cc58c7abfb32e5570b6f3 = Service::DomainCollection();$v21d6f40cfb511982e4424e0e250a9557 = Service::Session();$vdace572bc9325111a60cdfe28240da40 = $v21d6f40cfb511982e4424e0e250a9557->getMaxActiveTime();$vad5f82e879a9c5d6b5b442eb37e50551 = Service::DomainDetector()->detect();$v8512ae7d57b1396273f76fe6ed341a23 = Service::LanguageDetector()->detect();$result = [    '@module' => $this->getCurrentModule(),    '@method' => $this->getCurrentMethod(),    '@lang' => $v8512ae7d57b1396273f76fe6ed341a23->getPrefix(),    '@lang-id' => $v8512ae7d57b1396273f76fe6ed341a23->getId(),    '@pre-lang' => $this->getPreLang(),    '@domain' => $vad5f82e879a9c5d6b5b442eb37e50551->getHost(),    '@domain-id' => $vad5f82e879a9c5d6b5b442eb37e50551->getId(),    '@domain-url' => $vad5f82e879a9c5d6b5b442eb37e50551->getUrl(),    '@session-lifetime' => $vdace572bc9325111a60cdfe28240da40,    '@system-build' => $this->getSystemBuild(),    '@referer-uri' => $this->getCalculatedRefererUri(),    '@user-id' => Service::Auth()->getUserId(),    '@interface-lang' => ulangStream::getLangPrefix(),    '@csrf' => $v21d6f40cfb511982e4424e0e250a9557->get('csrf_token')   ];if (isDemoMode()) {$result['@demo'] = 1;}$result['@request-uri'] = Service::Request()->uriWithoutPageNumber();$result['@request-url'] = $vad5f82e879a9c5d6b5b442eb37e50551->getCurrentUrl() . Service::Request()->uri();$result['@edition'] = defined('CURRENT_VERSION_LINE') ? CURRENT_VERSION_LINE : '';$result['@disableTooManyChildsNotification'] = (int) mainConfiguration::getInstance()->get(    'system',    'disable-too-many-childs-notification'   );$va74846e5bcde649f23218b2e062c90a8 = $permissions->isAdmin();$v7f2db423a49b305459147332fb01cf87 = Service::Response()    ->getCurrentBuffer();$v8e44f0089b076e18a718eb9ca3d94674 = Service::Auth()->getUserId();switch (true) {case ($vb2767dac3edbe28998ccf00b2b64e303): {$result['data'] = new publicException(getLabel('error-ﾑ《rf-protection-check-failed'));$result['@error'] = getLabel('error-ﾑ《rf-protection-check-failed');break;}case ($va74846e5bcde649f23218b2e062c90a8 && $permissions->isAllowedDomain($result['@user-id'], $result['@domain-id']) == 0): {$result['data'] = new requreMoreAdminPermissionsException(getLabel('error-require-more-permissions'));$result['@error'] = getLabel('error-require-more-permissions');$v7f2db423a49b305459147332fb01cf87->status('403 Forbidden');break;}case $permissions->isAllowedMethod($v8e44f0089b076e18a718eb9ca3d94674, $this->getCurrentModule(), $this->getCurrentMethod()): {try {$v22884db148f0ffb0d830ba431102b0b5 = $this->getModule($this->getCurrentModule());if ($v22884db148f0ffb0d830ba431102b0b5) {$v22884db148f0ffb0d830ba431102b0b5->cms_callMethod($this->getCurrentMethod(), null);}$result['data'] = $this->adminDataSet;}catch (\UmiCms\System\Protection\CsrfException $ve1671797c52e15f763380b45e841ec32) {$result['data'] = new publicException(getLabel('error-ﾑ《rf-protection-check-failed'));$result['@error'] = getLabel('error-ﾑ《rf-protection-check-failed');}catch (publicException $ve1671797c52e15f763380b45e841ec32) {$result['data'] = $ve1671797c52e15f763380b45e841ec32;$result['@error'] = $ve1671797c52e15f763380b45e841ec32->getMessage();}break;}case $va74846e5bcde649f23218b2e062c90a8: {$result['data'] = new requreMoreAdminPermissionsException(getLabel('error-require-more-permissions'));$result['@error'] = getLabel('error-require-more-permissions');$v7f2db423a49b305459147332fb01cf87->status('403 Forbidden');break;}case ($this->getCurrentModule() != 'events' && $this->getCurrentMethod() != 'last'): {$v7f2db423a49b305459147332fb01cf87->status('403 Forbidden');break;}}if (($ve1d832ee855bdce9643cc79275650e83 = getRequest('domain')) !== null) {$result['@domain-floated'] = $ve1d832ee855bdce9643cc79275650e83;$result['@domain-floated-id'] = $ve4e46deb7f9cc58c7abfb32e5570b6f3->getDomainId($ve1d832ee855bdce9643cc79275650e83);}else {if ($this->currentEditElementId) {$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($this->currentEditElementId);if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof iUmiHierarchyElement) {$vad5f82e879a9c5d6b5b442eb37e50551 = $ve4e46deb7f9cc58c7abfb32e5570b6f3->getDomain($v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId());if ($vad5f82e879a9c5d6b5b442eb37e50551 instanceof iDomain) {$result['@domain-floated'] = $ve1d832ee855bdce9643cc79275650e83 = $vad5f82e879a9c5d6b5b442eb37e50551->getHost();}}}else {$result['@domain-floated'] = $result['@domain'];}}return $result;}private function prepareClientSideGlobalVariablesForTPL() {$permissions = permissionsCollection::getInstance();$v7b975dff6c0134c6f231fd13895c2349 = $this->getCurrentModule();$vb6ad8768e9a35023e3d824c5057699d1 = $this->getCurrentMethod();$v7552cd149af7495ee7d8225974e50f80 = $this->getCurrentElementId();$v8e44f0089b076e18a718eb9ca3d94674 = Service::Auth()->getUserId();$va5f3e7671419d689ba41872016aded04 = true;if ($permissions->isAllowedMethod($v8e44f0089b076e18a718eb9ca3d94674, $v7b975dff6c0134c6f231fd13895c2349, $vb6ad8768e9a35023e3d824c5057699d1)) {$va5f3e7671419d689ba41872016aded04 = false;if ($v7552cd149af7495ee7d8225974e50f80) {list($v4b43b0aee35624cd95b910189b3dc231) = $permissions->isAllowedObject($v8e44f0089b076e18a718eb9ca3d94674, $v7552cd149af7495ee7d8225974e50f80);$va5f3e7671419d689ba41872016aded04 = !$v4b43b0aee35624cd95b910189b3dc231;}}if ($va5f3e7671419d689ba41872016aded04) {$v7f2db423a49b305459147332fb01cf87 = Service::Response()     ->getCurrentBuffer();$v7f2db423a49b305459147332fb01cf87->status('401 Unauthorized');$this->setCurrentModule('users');$this->setCurrentMethod('login');$vf1e554b2b6ec1274154d202f76bf0e74 = $this->getModule('users');if (!$vf1e554b2b6ec1274154d202f76bf0e74) {throw new coreException('Module "users" not found.');}return ['content' => $vf1e554b2b6ec1274154d202f76bf0e74->login()];}$v22884db148f0ffb0d830ba431102b0b5 = $this->getModule($v7b975dff6c0134c6f231fd13895c2349);try {$v9a0364b9e99bb480dd25e1f0284c8555 = $v22884db148f0ffb0d830ba431102b0b5->cms_callMethod($vb6ad8768e9a35023e3d824c5057699d1, []);}catch (publicException $ve1671797c52e15f763380b45e841ec32) {$v9a0364b9e99bb480dd25e1f0284c8555 = $ve1671797c52e15f763380b45e841ec32->getMessage();}return ['content' => $v9a0364b9e99bb480dd25e1f0284c8555];}private function prepareClientSideGlobalVariablesForXSLT() {if ($this->useOnlyBaseClientVariables()) {return $this->getBaseClientVariables();}$v6d9fecd2868e8a635b6d088c3e8068c2 = [];$permissions = permissionsCollection::getInstance();$v69ae498121c2d8e63f20c7144a0246d7 = umiObjectsCollection::getInstance();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$vfa53b91ccc1b78668d5af58e1ed3a485 = Service::Auth();$v8e44f0089b076e18a718eb9ca3d94674 = $vfa53b91ccc1b78668d5af58e1ed3a485->getUserId();$v7552cd149af7495ee7d8225974e50f80 = $this->getCurrentElementId();$v7b975dff6c0134c6f231fd13895c2349 = $this->getCurrentModule();$vb6ad8768e9a35023e3d824c5057699d1 = $this->getCurrentMethod();$vca02d1555c813b1b1ad637654c0fe111 = false;if ($permissions->isAllowedMethod($v8e44f0089b076e18a718eb9ca3d94674, $v7b975dff6c0134c6f231fd13895c2349, $vb6ad8768e9a35023e3d824c5057699d1)) {$vca02d1555c813b1b1ad637654c0fe111 = true;if ($v7552cd149af7495ee7d8225974e50f80) {list($v71fd4b20b8d763009b1a7ee1c6f60769) = $permissions->isAllowedObject($v8e44f0089b076e18a718eb9ca3d94674, $v7552cd149af7495ee7d8225974e50f80);if (!$v71fd4b20b8d763009b1a7ee1c6f60769) {$vca02d1555c813b1b1ad637654c0fe111 = false;$v6d9fecd2868e8a635b6d088c3e8068c2['attribute:not-permitted'] = 1;}}}if (!$vca02d1555c813b1b1ad637654c0fe111) {$v7b975dff6c0134c6f231fd13895c2349 = 'users';$vb6ad8768e9a35023e3d824c5057699d1 = 'login';$this->setCurrentModule($v7b975dff6c0134c6f231fd13895c2349);$this->setCurrentMethod($vb6ad8768e9a35023e3d824c5057699d1);}$this->currentHeader = def_module::parseTPLMacroses(macros_header());$v6d9fecd2868e8a635b6d088c3e8068c2 = array_merge($v6d9fecd2868e8a635b6d088c3e8068c2, $this->getBaseClientVariables());if (Service::Request()->issetPageNumber()) {$v6d9fecd2868e8a635b6d088c3e8068c2['@paging'] = 'yes';}$v14e478589cc0c27c6e14f2eca7bc7ccd = $v8b1dc169bf460ee884fceef66c6607d6->getModule('social_networks');if ($v14e478589cc0c27c6e14f2eca7bc7ccd && ($v32a2f74bd1a12b30d1879b4b0ab59d64 = $v14e478589cc0c27c6e14f2eca7bc7ccd->getCurrentSocial())) {$v6d9fecd2868e8a635b6d088c3e8068c2['@socialId'] = $v32a2f74bd1a12b30d1879b4b0ab59d64->getId();$_REQUEST['template_id'] = (int) $v32a2f74bd1a12b30d1879b4b0ab59d64->getValue('template_id');$this->getCurrentTemplater(true);}$v6d9fecd2868e8a635b6d088c3e8068c2['@request-uri'] = Service::Request()->uriWithoutPageNumber();$v49f290d6e8459c53f31f97de37921086 = [];$v8e44f0089b076e18a718eb9ca3d94674 = $vfa53b91ccc1b78668d5af58e1ed3a485->getUserId();$v49f290d6e8459c53f31f97de37921086['@id'] = $v8e44f0089b076e18a718eb9ca3d94674;$v3d88fcbaa3581c4957147ef9ad47ec5e = 'guest';if (Service::Auth()->isAuthorized() && ($vee11cbb19052e40b07aac0ca060c23ee = $v69ae498121c2d8e63f20c7144a0246d7->getObject($v8e44f0089b076e18a718eb9ca3d94674))) {if (getRequest('mobile_application') == 'true') {if (!Service::Registry()->get('//modules/emarket/')) {$v6d9fecd2868e8a635b6d088c3e8068c2['data']['error'] = getLabel('error-module-emarket-absent');return $v6d9fecd2868e8a635b6d088c3e8068c2;}if (!$permissions->isAllowedMethod($v8e44f0089b076e18a718eb9ca3d94674, 'emarket', 'mobile_application_get_data')) {$v6d9fecd2868e8a635b6d088c3e8068c2['data']['error'] = getLabel('error-mobile-application-not-allowed');return $v6d9fecd2868e8a635b6d088c3e8068c2;}}$v3d88fcbaa3581c4957147ef9ad47ec5e = 'user';$v49f290d6e8459c53f31f97de37921086['@status'] = 'auth';$v49f290d6e8459c53f31f97de37921086['@login'] = $vee11cbb19052e40b07aac0ca060c23ee->getValue('login');$v49f290d6e8459c53f31f97de37921086['xlink:href'] = $vee11cbb19052e40b07aac0ca060c23ee->getXlink();if ($permissions->isAdmin()) {$v3d88fcbaa3581c4957147ef9ad47ec5e = 'admin';if ($permissions->isSv()) {$v3d88fcbaa3581c4957147ef9ad47ec5e = 'sv';}}}$v49f290d6e8459c53f31f97de37921086['@type'] = $v3d88fcbaa3581c4957147ef9ad47ec5e;$vabb341de59578cc2eefc8b95d451142b = $this->getModule('geoip');if ($vabb341de59578cc2eefc8b95d451142b) {$v79efe6caeb0a0dcbb0d0b040372613a6 = $vabb341de59578cc2eefc8b95d451142b->lookupIp();if (isset($v79efe6caeb0a0dcbb0d0b040372613a6['special'])) {$v49f290d6e8459c53f31f97de37921086['geo'] = ['special' => $v79efe6caeb0a0dcbb0d0b040372613a6['special']];}else {$v49f290d6e8459c53f31f97de37921086['geo'] = [      'country' => $v79efe6caeb0a0dcbb0d0b040372613a6['country'],      'region' => $v79efe6caeb0a0dcbb0d0b040372613a6['region'],      'city' => $v79efe6caeb0a0dcbb0d0b040372613a6['city'],      'latitude' => $v79efe6caeb0a0dcbb0d0b040372613a6['lat'],      'longitude' => $v79efe6caeb0a0dcbb0d0b040372613a6['lon']     ];}}$v6d9fecd2868e8a635b6d088c3e8068c2['user'] = $v49f290d6e8459c53f31f97de37921086;if ($v7552cd149af7495ee7d8225974e50f80 && ($v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80))) {$v587a02d1eb09e2b2fd6514d36a7c3438 = $vb81ca7c0ccaa77e7aa91936ab0070695->getAllParents($v7552cd149af7495ee7d8225974e50f80);$v8e13d18cd44dd15da3533bd4db912ab8 = [];foreach ($v587a02d1eb09e2b2fd6514d36a7c3438 as $v72352a4d26581ef082a6d2243c5a6b88) {if ($v72352a4d26581ef082a6d2243c5a6b88 == 0) {continue;}$va4f09cfeea7392a1f6df6a3de5c3bc9e = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v72352a4d26581ef082a6d2243c5a6b88);if ($va4f09cfeea7392a1f6df6a3de5c3bc9e) {$v8e13d18cd44dd15da3533bd4db912ab8[] = $va4f09cfeea7392a1f6df6a3de5c3bc9e;}}$v6d9fecd2868e8a635b6d088c3e8068c2 += [     '@pageId' => $v7552cd149af7495ee7d8225974e50f80,     'parents' => [      '+page' => $v8e13d18cd44dd15da3533bd4db912ab8     ],     'full:page' => $v8e2dcfd7e7e24b1ca76c1193f645902b    ];def_module::pushEditable($v7b975dff6c0134c6f231fd13895c2349, $vb6ad8768e9a35023e3d824c5057699d1, $v7552cd149af7495ee7d8225974e50f80);}elseif ($v7b975dff6c0134c6f231fd13895c2349 == 'content' && $vb6ad8768e9a35023e3d824c5057699d1 == 'content') {$v6d9fecd2868e8a635b6d088c3e8068c2['@method'] = 'notfound';}elseif ($vca02d1555c813b1b1ad637654c0fe111 && $this->isAllowedExecuteMethod($v7b975dff6c0134c6f231fd13895c2349, $vb6ad8768e9a35023e3d824c5057699d1)) {try {$v1bbcb648e0b1869444f3a2d344a5b3ac = Service::Request()->getCleanPathParts();if (isset($v1bbcb648e0b1869444f3a2d344a5b3ac[0]) && $v1bbcb648e0b1869444f3a2d344a5b3ac[0] == Service::LanguageDetector()->detectPrefix()) {$v1bbcb648e0b1869444f3a2d344a5b3ac = array_slice($v1bbcb648e0b1869444f3a2d344a5b3ac, 1);}$v1bbcb648e0b1869444f3a2d344a5b3ac[0] = $v7b975dff6c0134c6f231fd13895c2349;$v1bbcb648e0b1869444f3a2d344a5b3ac[1] = $vb6ad8768e9a35023e3d824c5057699d1;if ($this->canReturnArrayFromMacrosExecution()) {$v22884db148f0ffb0d830ba431102b0b5 = $v8b1dc169bf460ee884fceef66c6607d6->getModule($v7b975dff6c0134c6f231fd13895c2349);$v1bbcb648e0b1869444f3a2d344a5b3ac = array_slice($v1bbcb648e0b1869444f3a2d344a5b3ac, 2);$v6d9fecd2868e8a635b6d088c3e8068c2['data'] = call_user_func_array([$v22884db148f0ffb0d830ba431102b0b5, $vb6ad8768e9a35023e3d824c5057699d1], $v1bbcb648e0b1869444f3a2d344a5b3ac);}else {$vd6fe1d0be6347b8ef2427fa629c04485 = 'udata://' . implode('/', $v1bbcb648e0b1869444f3a2d344a5b3ac);$v6d9fecd2868e8a635b6d088c3e8068c2['xml:data'] = $this->executeStream($vd6fe1d0be6347b8ef2427fa629c04485);}}catch (publicException $ve1671797c52e15f763380b45e841ec32) {$v6d9fecd2868e8a635b6d088c3e8068c2['data'] = $ve1671797c52e15f763380b45e841ec32;}}return $v6d9fecd2868e8a635b6d088c3e8068c2;}private function canReturnArrayFromMacrosExecution() {$v3f48301f2668ec4eec370518ddcffe63 = mainConfiguration::getInstance();$v327a6c4304ad5938eaf0efb6cc3e53dc = (bool) $v3f48301f2668ec4eec370518ddcffe63->get('system', 'return-array-from-macros-execution');return $v327a6c4304ad5938eaf0efb6cc3e53dc && ($this->getCurrentTemplater() instanceof umiTemplaterPHP);}private function getBaseClientVariables() {$vad5f82e879a9c5d6b5b442eb37e50551 = Service::DomainDetector()->detect();$v8512ae7d57b1396273f76fe6ed341a23 = Service::LanguageDetector()->detect();$v87cd8b8808600624d8c590cfc2e6e94b = [    '@module' => $this->getCurrentModule(),    '@method' => $this->getCurrentMethod(),    '@domain' => $vad5f82e879a9c5d6b5b442eb37e50551->getHost(),    '@domain-id' => $vad5f82e879a9c5d6b5b442eb37e50551->getId(),    '@domain-url' => $vad5f82e879a9c5d6b5b442eb37e50551->getUrl(),    '@system-build' => $this->getSystemBuild(),    '@lang' => $v8512ae7d57b1396273f76fe6ed341a23->getPrefix(),    '@lang-id' => $v8512ae7d57b1396273f76fe6ed341a23->getId(),    '@pre-lang' => $this->getPreLang(),    '@header' => def_module::parseTPLMacroses(macros_header()),    '@title' => def_module::parseTPLMacroses(macros_title()),    '@site-name' => def_module::parseTPLMacroses(macros_sitename()),    '@csrf' => Service::Session()->get('csrf_token'),    'meta' => [     'keywords' => macros_keywords(),     'description' => macros_describtion()    ],    '@request-url' => $vad5f82e879a9c5d6b5b442eb37e50551->getCurrentUrl() . Service::Request()->uri()   ];$v66f6181bcb4cff4cd38fbc804a036db6 = $this->getCurrentTemplate();if ($v66f6181bcb4cff4cd38fbc804a036db6 instanceof iTemplate) {$v87cd8b8808600624d8c590cfc2e6e94b['@template-id'] = $v66f6181bcb4cff4cd38fbc804a036db6->getId();}if (isDemoMode()) {$v87cd8b8808600624d8c590cfc2e6e94b['@demo'] = 1;}if ($this->getCurrentElementId()) {$v87cd8b8808600624d8c590cfc2e6e94b['@pageId'] = $this->getCurrentElementId();$ve558e63f3083922542d8745224a66eea = ($v87cd8b8808600624d8c590cfc2e6e94b['@pageId'] === umiHierarchy::getInstance()->getDefaultElementId());$v87cd8b8808600624d8c590cfc2e6e94b['@is-default'] = $ve558e63f3083922542d8745224a66eea;}return $v87cd8b8808600624d8c590cfc2e6e94b;}private function getSystemBuild() {return Service::RegistrySettings()->getRevision();}private function getCurrentDesignTemplate() {return Service::Request()->isAdmin()    ? templatesCollection::getInstance()->getDefaultTemplate()    : $this->detectCurrentDesignTemplate();}private function useOnlyBaseClientVariables() {return (bool) mainConfiguration::getInstance()    ->get('system', 'use-only-base-client-variables');}private function detectCurrentTemplater() {if (defined('VIA_HTTP_SCHEME') && VIA_HTTP_SCHEME) {return $this->current_templater = $this->initHTTPSchemeModeTemplater();}if (Service::Request()->isAdmin()) {\outputBuffer::contentGenerator('XSLT, ADMIN MODE');$this->current_templater = Service::AdminTemplater();return $this->current_templater;}return $this->current_templater = $this->initSiteModeTemplater();}private function processCaseSensitiveUrl(iOutputBuffer $v7f2db423a49b305459147332fb01cf87, $v572d4e421e5e6b9bc11d815e8a027112) {$v72ee76c5c29383b7c9f9225c1fa4d10b = Service::DomainDetector()->detectId();$v694b5b6b5536d28285396c8ce7c268bc = Service::LanguageDetector()->detectId();$va9205dcfd4a6f7c2cbe8be01566ff84a = Service::Registry();switch ($va9205dcfd4a6f7c2cbe8be01566ff84a->get("//settings/seo/$v72ee76c5c29383b7c9f9225c1fa4d10b/$v694b5b6b5536d28285396c8ce7c268bc/case-sensitive-status")) {case 'redirect': {$v7f2db423a49b305459147332fb01cf87->status('301 Moved Permanently');$v7f2db423a49b305459147332fb01cf87->redirect($v572d4e421e5e6b9bc11d815e8a027112);break;}case 'not-found': {$this->setNotFoundState();$v7f2db423a49b305459147332fb01cf87->status('404 Not Found');break;}}}private function addSuffixToPath($vd6fe1d0be6347b8ef2427fa629c04485) {$vccd1066343c95877b75b79d47c36bebe = mainConfiguration::getInstance();if (!$vccd1066343c95877b75b79d47c36bebe->get('seo', 'url-suffix.add')) {return $vd6fe1d0be6347b8ef2427fa629c04485;}$v4ec1b477cd0232b832c1899905ec51a4 = $vccd1066343c95877b75b79d47c36bebe->get('seo', 'url-suffix');return endsWith($vd6fe1d0be6347b8ef2427fa629c04485, $v4ec1b477cd0232b832c1899905ec51a4) ? $vd6fe1d0be6347b8ef2427fa629c04485 : ($vd6fe1d0be6347b8ef2427fa629c04485 . $v4ec1b477cd0232b832c1899905ec51a4);}private function isCaseSensitiveAltName() {$v72ee76c5c29383b7c9f9225c1fa4d10b = Service::DomainDetector()->detectId();$v694b5b6b5536d28285396c8ce7c268bc = Service::LanguageDetector()->detectId();return Service::Registry()->get("//settings/seo/$v72ee76c5c29383b7c9f9225c1fa4d10b/$v694b5b6b5536d28285396c8ce7c268bc/case-sensitive");}private function initHTTPSchemeModeTemplater() {outputBuffer::contentGenerator('XSLT, HTTP SCHEME MODE');return umiTemplater::create('XSLT');}private function initSiteModeTemplater() {$vc2b8233aa336e4ee279bb26c4205ccd3 = $this->getModule('social_networks');if ($vc2b8233aa336e4ee279bb26c4205ccd3 instanceof social_networks && $vc2b8233aa336e4ee279bb26c4205ccd3->getCurrentSocial() && !getRequest('template_id')) {return $this->createDefaultSocialNetWorkTemplate();}$v66f6181bcb4cff4cd38fbc804a036db6 = $this->detectCurrentDesignTemplate();if (!$v66f6181bcb4cff4cd38fbc804a036db6 instanceof iTemplate) {$v7f2db423a49b305459147332fb01cf87 = Service::Response()     ->getCurrentBuffer();$v7f2db423a49b305459147332fb01cf87->clear();$v7f2db423a49b305459147332fb01cf87->crash('no_design_template');}$va488c14d97fc1b1a156f093b14cbc607 = $v66f6181bcb4cff4cd38fbc804a036db6->getType();if ($va488c14d97fc1b1a156f093b14cbc607 == 'xsl') {$va488c14d97fc1b1a156f093b14cbc607 = 'XSLT';}if ($va488c14d97fc1b1a156f093b14cbc607 == 'tpls') {$va488c14d97fc1b1a156f093b14cbc607 = 'TPL';}$va488c14d97fc1b1a156f093b14cbc607 = mb_strtoupper($va488c14d97fc1b1a156f093b14cbc607);outputBuffer::contentGenerator($va488c14d97fc1b1a156f093b14cbc607 . ', SITE MODE');try {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$v2245023265ae4cf87d02c8b6ba991139->loadConfig($v66f6181bcb4cff4cd38fbc804a036db6->getConfigPath());$v2245023265ae4cf87d02c8b6ba991139->setReadOnlyConfig();}catch (Exception $v42552b1f133f9f8eb406d4f306ea9fd1) {}return umiTemplater::create($va488c14d97fc1b1a156f093b14cbc607, $v66f6181bcb4cff4cd38fbc804a036db6->getFilePath());}private function createDefaultSocialNetWorkTemplate() {return umiTemplater::create(    'XSLT',    CURRENT_WORKING_DIR  . '/styles/common/xsl/social/vkontakte.xsl'   );}private function getSubPathType($vb31590b98760b74e7c4e1a809e43152d) {if (!$this->getCurrentModule()) {if (Service::Registry()->get('//modules/' . $vb31590b98760b74e7c4e1a809e43152d)) {$this->setCurrentModule($vb31590b98760b74e7c4e1a809e43152d);return 'MODULE';}}if ($this->getCurrentModule() && !$this->getCurrentMethod()) {$this->setCurrentMethod($vb31590b98760b74e7c4e1a809e43152d);return 'METHOD';}if ($this->getCurrentModule() && $this->getCurrentMethod()) {return 'PARAM';}return 'UNKNOWN';}private function reset() {$this->setCurrentModule('');$this->setCurrentMethod('');for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < 10;$v865c0c0b4ab0e063e5caa3387c1a8741++) {if (isset($_REQUEST['param' . $v865c0c0b4ab0e063e5caa3387c1a8741])) {unset($_REQUEST['param' . $v865c0c0b4ab0e063e5caa3387c1a8741]);}else {break;}}}private function detectPreLang() {$vc7998d8b485a9d8075971e7056de2f65 = Service::LanguageDetector()->detect();$vf6afee894b3508441e878b464a92f4b0 = Service::DomainDetector()->detect();if ($vc7998d8b485a9d8075971e7056de2f65->getId() != $vf6afee894b3508441e878b464a92f4b0->getDefaultLangId()) {$ve37dba8070521125c5fd46d6d2730627 = '/' . $vc7998d8b485a9d8075971e7056de2f65->getPrefix();}else {$ve37dba8070521125c5fd46d6d2730627 = '';}$_REQUEST['pre_lang'] = $ve37dba8070521125c5fd46d6d2730627;$this->setPreLang($ve37dba8070521125c5fd46d6d2730627);}private function loadLangConstantList() {$v20cf12be6809c539cfed17c272627718 = $this->getModulesList();try {$v535d02e594853266d2db02ff178dd7f7 = Service::LanguageDetector()->detectPrefix();}catch (coreException $v42552b1f133f9f8eb406d4f306ea9fd1) {umiExceptionHandler::report($v42552b1f133f9f8eb406d4f306ea9fd1);return [];}$v4a527f83a3a4ca7e1d70adb26a35b72e = new I18nFilesLoader($v20cf12be6809c539cfed17c272627718, $v535d02e594853266d2db02ff178dd7f7);try {$v06f0066e65410a0a1c9f39991a3f3b01 = $this->getResourcesDirectory();$v4a527f83a3a4ca7e1d70adb26a35b72e->setTemplatePath($v06f0066e65410a0a1c9f39991a3f3b01);}catch (Exception $v42552b1f133f9f8eb406d4f306ea9fd1) {umiExceptionHandler::report($v42552b1f133f9f8eb406d4f306ea9fd1);}return $v4a527f83a3a4ca7e1d70adb26a35b72e->loadLangConstants();}public static function isCSRFTokenValid() {try {return Service::Protection()->checkCsrf();}catch (\UmiCms\System\Protection\CsrfException $ve1671797c52e15f763380b45e841ec32) {return false;}}public function getLang() {return Service::LanguageDetector()->detect();}public function setLang(iLang $v7572559ca86e781ba8fe8073a0b725c6) {trigger_error('Method is not working anymore', E_USER_WARNING);return $this;}public function getSkinPath() {return null;}public function loadBuildInModule($v52a43e48ec4649dee819dadabcab1bde) {return null;}public function loadExtLang($v52a43e48ec4649dee819dadabcab1bde) {return null;}public function loadLangs() {return null;}public function getCurrentMode() {return Service::Request()    ->mode();}public function setCurrentMode($v15d61712450a686a7f365adf4fef581f) {trigger_error('Method is not working anymore', E_USER_WARNING);return $this;}public function getAdminModeId() {return \UmiCms\System\Request\Mode\iDetector::ADMIN_MODE;}public function isCurrentModeAdmin() {return Service::Request()    ->isAdmin();}public function getCurrentDomain() {return Service::DomainDetector()->detect();}public function setCurrentDomain(iDomain $vad5f82e879a9c5d6b5b442eb37e50551) {trigger_error('Method is not working anymore', E_USER_WARNING);return $this;}public function getCurrentLang() {return Service::LanguageDetector()->detect();}public function setCurrentLang(iLang $v7572559ca86e781ba8fe8073a0b725c6) {trigger_error('Method is not working anymore', E_USER_WARNING);return $this;}public function setCurrentTemplater() {return $this->getCurrentTemplater();}}
