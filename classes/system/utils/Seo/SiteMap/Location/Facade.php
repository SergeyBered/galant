<?php
 namespace UmiCms\Classes\System\Utils\SiteMap\Location;use UmiCms\System\Orm\iEntity;use \iUmiEventPoint as iEvent;use UmiCms\Classes\System\Utils\SiteMap\iImage;use UmiCms\Classes\System\Utils\SiteMap\iLocation;use UmiCms\System\Orm\Entity\Facade as AbstractFacade;use UmiCms\Classes\System\Utils\SiteMap\Image\iFacade as iImageFacade;class Facade extends AbstractFacade implements iFacade {private $imageFacade;public function create(array $v6dd047148d685270458ecc44ee128a4d = []) {if (!isset($v6dd047148d685270458ecc44ee128a4d[iMapper::DOMAIN_ID])) {throw new \ErrorException('Domain id expected');}if (!isset($v6dd047148d685270458ecc44ee128a4d[iMapper::LINK])) {throw new \ErrorException('Link expected');}if (!isset($v6dd047148d685270458ecc44ee128a4d[iMapper::SORT])) {throw new \ErrorException('Sort index expected');}if (!isset($v6dd047148d685270458ecc44ee128a4d[iMapper::PRIORITY])) {throw new \ErrorException('Priority expected');}if (!isset($v6dd047148d685270458ecc44ee128a4d[iMapper::DATE_TIME])) {throw new \ErrorException('Date time expected');}if (!isset($v6dd047148d685270458ecc44ee128a4d[iMapper::LEVEL])) {throw new \ErrorException('Level expected');}if (!isset($v6dd047148d685270458ecc44ee128a4d[iMapper::LANGUAGE_ID])) {throw new \ErrorException('Language id expected');}return parent::create($v6dd047148d685270458ecc44ee128a4d);}public function save(iEntity $vd5189de027922f81005951e6efe0efd5) {parent::save($vd5189de027922f81005951e6efe0efd5);foreach ($vd5189de027922f81005951e6efe0efd5->getImageCollection() as $v78805a221a988e79ef3f42d7c5bfd418) {$this->imageFacade->save($v78805a221a988e79ef3f42d7c5bfd418);}return $this;}public function delete($vb80bb7740288fda1f201890375a60c8f) {$vd5189de027922f81005951e6efe0efd5 = parent::get($vb80bb7740288fda1f201890375a60c8f);if ($this->isValidEntity($vd5189de027922f81005951e6efe0efd5)) {$va3f93c7c6fa562d17a5ed61646e064d7 = $vd5189de027922f81005951e6efe0efd5->getImageCollection()     ->extractId();$this->imageFacade->deleteList($va3f93c7c6fa562d17a5ed61646e064d7);}return parent::delete($vb80bb7740288fda1f201890375a60c8f);}public function copy(iEntity $va215871ce551fdb69f3a2ad969ad0815) {$v6dd047148d685270458ecc44ee128a4d = $this->extractAttributeList($va215871ce551fdb69f3a2ad969ad0815);$v693442550cf88fe2f8a6371b492a58f6 = $this->create($v6dd047148d685270458ecc44ee128a4d);try {foreach ($va215871ce551fdb69f3a2ad969ad0815->getImageCollection() as $vadd3055bdf11d28a64794438ba67d0c8) {$vc8475ca8fd26d4384faae201b6f54930 = $this->imageFacade->copy($vadd3055bdf11d28a64794438ba67d0c8);$vc8475ca8fd26d4384faae201b6f54930->setLocationId($v693442550cf88fe2f8a6371b492a58f6->getId());$this->imageFacade->save($vc8475ca8fd26d4384faae201b6f54930);}}catch (\Exception $v42552b1f133f9f8eb406d4f306ea9fd1) {if ($v693442550cf88fe2f8a6371b492a58f6 instanceof iLocation) {$this->delete($v693442550cf88fe2f8a6371b492a58f6->getId());}throw $v42552b1f133f9f8eb406d4f306ea9fd1;}return $v693442550cf88fe2f8a6371b492a58f6;}public function createByEvent(iEvent $v4119639092e62c55ea8be348e4d9260d) : iLocation {return $this->create([    iMapper::ID => $v4119639092e62c55ea8be348e4d9260d->getParam('id'),    iMapper::DOMAIN_ID => $v4119639092e62c55ea8be348e4d9260d->getParam('domainId'),    iMapper::LINK => $v4119639092e62c55ea8be348e4d9260d->getParam('link'),    iMapper::SORT => $v4119639092e62c55ea8be348e4d9260d->getParam('sort'),    iMapper::PRIORITY => $v4119639092e62c55ea8be348e4d9260d->getParam('pagePriority'),    iMapper::DATE_TIME => $v4119639092e62c55ea8be348e4d9260d->getParam('updateTime'),    iMapper::LEVEL => $v4119639092e62c55ea8be348e4d9260d->getParam('level'),    iMapper::LANGUAGE_ID => $v4119639092e62c55ea8be348e4d9260d->getParam('langId'),    iMapper::CHANGE_FREQUENCY => $v4119639092e62c55ea8be348e4d9260d->getParam('changeFrequency')   ]);}public function getIndexListByDomain(int $vb80bb7740288fda1f201890375a60c8f) : array {return $this->getRepository()    ->getIndexListForDomain($vb80bb7740288fda1f201890375a60c8f);}public function getCountByDomain(int $vb80bb7740288fda1f201890375a60c8f) : int {return $this->getRepository()    ->getCountByDomain($vb80bb7740288fda1f201890375a60c8f);}public function getCollectionByDomain(int $vb80bb7740288fda1f201890375a60c8f) : iCollection {$v10ae9fc7d453b0dd525d0edf2ede7961 = $this->getRepository()     ->getListByDomain($vb80bb7740288fda1f201890375a60c8f);return $this->mapCollection($v10ae9fc7d453b0dd525d0edf2ede7961);}public function getCollectionByDomainAndSort(int $vb80bb7740288fda1f201890375a60c8f, int $vcadc8c8db42409733582cb3e2298ef87) : iCollection {$v10ae9fc7d453b0dd525d0edf2ede7961 = $this->getRepository()    ->getListByDomainAndSort($vb80bb7740288fda1f201890375a60c8f, $vcadc8c8db42409733582cb3e2298ef87);return $this->mapCollection($v10ae9fc7d453b0dd525d0edf2ede7961);}public function deleteByDomain(int $vb80bb7740288fda1f201890375a60c8f) : iFacade {$this->getRepository()    ->deleteByDomain($vb80bb7740288fda1f201890375a60c8f);return $this;}public function setImageFacade(iImageFacade $ve6db6d90cce0b60a71b353564e9fbe36) : iFacade {$this->imageFacade = $ve6db6d90cce0b60a71b353564e9fbe36;return $this;}protected function isValidEntity($vf5e638cc78dd325906c1298a0c21fb6b) {return $vf5e638cc78dd325906c1298a0c21fb6b instanceof iLocation;}}