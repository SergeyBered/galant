<?php
 namespace UmiCms\Classes\System\Utils\SiteMap;use UmiCms\Classes\System\Utils\DOM\Document\iFactory as iDocumentFactory;use UmiCms\Classes\System\Utils\SiteMap\Location\iFacade as iLocationFacade;use UmiCms\Classes\System\Utils\SiteMap\Location\iCollection as iLocationCollection;class Generator implements iGenerator {protected $locationFacade;protected $documentFactory;public function __construct(iLocationFacade $v71c548f4ea56fe180189691eaaa41803, iDocumentFactory $v126821e2de2dcbc656ef28b6fc1cc6f8) {$this->locationFacade = $v71c548f4ea56fe180189691eaaa41803;$this->documentFactory = $v126821e2de2dcbc656ef28b6fc1cc6f8;}public function getIndex(\iDomain $vad5f82e879a9c5d6b5b442eb37e50551, $vaa9f73eea60a006820d0f8768bc8a3fc = self::SEARCH_ENGINES_SITE_MAP_URL_LIMIT) {$v72ee76c5c29383b7c9f9225c1fa4d10b = $vad5f82e879a9c5d6b5b442eb37e50551->getId();$ve2942a04780e223b215eb8b663cf5353 = $this->locationFacade->getCountByDomain($v72ee76c5c29383b7c9f9225c1fa4d10b);if ($ve2942a04780e223b215eb8b663cf5353 > 0 && $ve2942a04780e223b215eb8b663cf5353 > $vaa9f73eea60a006820d0f8768bc8a3fc) {return $this->genSiteIndex($vad5f82e879a9c5d6b5b442eb37e50551);}return $this->genSiteMap($v72ee76c5c29383b7c9f9225c1fa4d10b);}public function getByPageNumber(\iDomain $vad5f82e879a9c5d6b5b442eb37e50551, $v37762d11479e633bc60b4d306ebffa55) {$v37762d11479e633bc60b4d306ebffa55 = (int) $v37762d11479e633bc60b4d306ebffa55;return $this->genSiteMap($vad5f82e879a9c5d6b5b442eb37e50551->getId(), $v37762d11479e633bc60b4d306ebffa55);}public function getEmpty() {$vcbfd332fb812e46fb6569ec4ad91f1d5 = $this->getContainerTags();return $vcbfd332fb812e46fb6569ec4ad91f1d5[0] . $vcbfd332fb812e46fb6569ec4ad91f1d5[1];}protected function getContainerTags() : array {return [    '<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">',    '</urlset>',   ];}protected function getSiteIndexLocation(\iDomain $vad5f82e879a9c5d6b5b442eb37e50551, int $vcadc8c8db42409733582cb3e2298ef87) : string {return sprintf('%s://%s/sitemap%d.xml', $vad5f82e879a9c5d6b5b442eb37e50551->getProtocol(), $vad5f82e879a9c5d6b5b442eb37e50551->getHost(), $vcadc8c8db42409733582cb3e2298ef87);}protected function getLocationCollection(int $v72ee76c5c29383b7c9f9225c1fa4d10b, int $vcadc8c8db42409733582cb3e2298ef87 = null) : iLocationCollection {if ($vcadc8c8db42409733582cb3e2298ef87 !== null) {return $this->locationFacade->getCollectionByDomainAndSort($v72ee76c5c29383b7c9f9225c1fa4d10b, $vcadc8c8db42409733582cb3e2298ef87);}return $this->locationFacade->getCollectionByDomain($v72ee76c5c29383b7c9f9225c1fa4d10b);}protected function getLocationXml(iLocation $vd5189de027922f81005951e6efe0efd5) : \DOMDocument {$vdd988cfd769c9f7fbd795a0f5da8e751 = $this->documentFactory->create();$v572d4e421e5e6b9bc11d815e8a027112 = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('url');$vce04bd8105c135f89b0dfd5d9c1e8c5d = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('loc', $vd5189de027922f81005951e6efe0efd5->getLink());$vb988295c268025b49dfb3df26171ddc3 = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('priority', $vd5189de027922f81005951e6efe0efd5->getPriority());$v5fc732311905cb27e82d67f4f6511f7f = date('c', strtotime($vd5189de027922f81005951e6efe0efd5->getDateTime()));$v3c1bdc1738b3e10d1a55bf95ead5ba86 = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('lastmod', $v5fc732311905cb27e82d67f4f6511f7f);$vdd988cfd769c9f7fbd795a0f5da8e751->appendChild($v572d4e421e5e6b9bc11d815e8a027112);$v572d4e421e5e6b9bc11d815e8a027112->appendChild($vce04bd8105c135f89b0dfd5d9c1e8c5d);$v572d4e421e5e6b9bc11d815e8a027112->appendChild($v3c1bdc1738b3e10d1a55bf95ead5ba86);$v572d4e421e5e6b9bc11d815e8a027112->appendChild($vb988295c268025b49dfb3df26171ddc3);$v14d4e53ca531d9fbd0c0e01d4064cf7c = $vd5189de027922f81005951e6efe0efd5->getChangeFrequency();if ($v14d4e53ca531d9fbd0c0e01d4064cf7c) {$v7e1e8fb1e1db5bdcf4e6fd0071d17413 = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('changefreq', $v14d4e53ca531d9fbd0c0e01d4064cf7c);$v572d4e421e5e6b9bc11d815e8a027112->appendChild($v7e1e8fb1e1db5bdcf4e6fd0071d17413);}return $vdd988cfd769c9f7fbd795a0f5da8e751;}private function genSiteIndex(\iDomain $vad5f82e879a9c5d6b5b442eb37e50551) {$v7c27c416b75c77012f5c378837e5bb19 = '<sitemapindex xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">';foreach ($this->locationFacade->getIndexListByDomain($vad5f82e879a9c5d6b5b442eb37e50551->getId()) as $vf1965a857bc285d26fe22023aa5ab50d) {list($vcadc8c8db42409733582cb3e2298ef87, $v5fa40b2485d1096a170d2d7ecd0f7030) = $vf1965a857bc285d26fe22023aa5ab50d;$vdd988cfd769c9f7fbd795a0f5da8e751 = $this->documentFactory->create();$v572d4e421e5e6b9bc11d815e8a027112 = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('sitemap');$vce04bd8105c135f89b0dfd5d9c1e8c5d = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('loc', $this->getSiteIndexLocation($vad5f82e879a9c5d6b5b442eb37e50551, (int) $vcadc8c8db42409733582cb3e2298ef87));$v3c1bdc1738b3e10d1a55bf95ead5ba86 = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('lastmod', date('c', strtotime($v5fa40b2485d1096a170d2d7ecd0f7030)));$vdd988cfd769c9f7fbd795a0f5da8e751->appendChild($v572d4e421e5e6b9bc11d815e8a027112);$v572d4e421e5e6b9bc11d815e8a027112->appendChild($vce04bd8105c135f89b0dfd5d9c1e8c5d);$v572d4e421e5e6b9bc11d815e8a027112->appendChild($v3c1bdc1738b3e10d1a55bf95ead5ba86);$v7c27c416b75c77012f5c378837e5bb19 .= $vdd988cfd769c9f7fbd795a0f5da8e751->saveXML($v572d4e421e5e6b9bc11d815e8a027112);}$v7c27c416b75c77012f5c378837e5bb19 .= '</sitemapindex>';return $v7c27c416b75c77012f5c378837e5bb19;}private function genSiteMap($v72ee76c5c29383b7c9f9225c1fa4d10b, $v37762d11479e633bc60b4d306ebffa55 = null) {$vcbfd332fb812e46fb6569ec4ad91f1d5 = $this->getContainerTags();$v7c27c416b75c77012f5c378837e5bb19 = $vcbfd332fb812e46fb6569ec4ad91f1d5[0];$vb832f401a4b70507cda2c8ea357c7b17 = $this->getLocationCollection($v72ee76c5c29383b7c9f9225c1fa4d10b, $v37762d11479e633bc60b4d306ebffa55);foreach ($vb832f401a4b70507cda2c8ea357c7b17 as $vd5189de027922f81005951e6efe0efd5) {$vfdc3bdefb79cec8eb8211d2499e04704 = $this->getLocationXml($vd5189de027922f81005951e6efe0efd5);$v572d4e421e5e6b9bc11d815e8a027112 = $vfdc3bdefb79cec8eb8211d2499e04704->getElementsByTagName('url')->item(0);$v7c27c416b75c77012f5c378837e5bb19 .= $vfdc3bdefb79cec8eb8211d2499e04704->saveXML($v572d4e421e5e6b9bc11d815e8a027112);}$v7c27c416b75c77012f5c378837e5bb19 .= $vcbfd332fb812e46fb6569ec4ad91f1d5[1];;return $v7c27c416b75c77012f5c378837e5bb19;}}